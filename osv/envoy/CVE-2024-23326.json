{
  "modified": "2024-06-04T19:39:24Z",
  "published": "2024-06-04T19:39:24Z",
  "schema_version": "1.5.0",
  "id": "CVE-2024-23326",
  "aliases": [
    "GHSA-vcf8-7238-v74c"
  ],
  "details": "### Summary\r\n\r\nA theoretical request smuggling vulnerability exists through Envoy if a server can be tricked into adding an upgrade header into a response.\r\n\r\n### Details\r\nPer RFC https://www.rfc-editor.org/rfc/rfc7230#section-6.7 a server sends `101` when switching protocols.\r\n\r\nEnvoy incorrectly accepts a `200` response from a server when requesting a protocol upgrade, but `200` does not indicate protocol switch.\r\n\r\nThis opens up the possibility of request smuggling through Envoy if the server can be tricked into adding the upgrade header to the response.\r\n\r\n### Credits\r\n\r\nreporter: rory.mcnamara@snyk.io",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.27.6"
            },
            {
              "introduced": "1.28.0"
            },
            {
              "fixed": "1.28.4"
            },
            {
              "introduced": "1.29.0"
            },
            {
              "fixed": "1.29.5"
            },
            {
              "introduced": "1.30.0"
            },
            {
              "fixed": "1.30.2"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "envoyproxy",
        "source_package": "source/common/router"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-vcf8-7238-v74c"
    }
  ]
}