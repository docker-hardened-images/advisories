{
  "modified": "2021-10-04T11:31:23Z",
  "published": "2021-10-04T11:31:23Z",
  "schema_version": "1.5.0",
  "id": "CVE-2021-32628",
  "aliases": [
    "GHSA-vw22-qm3h-49pr"
  ],
  "details": "### Impact\r\nAn integer overflow bug in the ziplist data structure used by all versions of Redis can be exploited to corrupt the heap and potentially result with remote code execution.\r\n\r\nThe vulnerability involves modifying the default ziplist configuration parameters (`hash-max-ziplist-entries`, `hash-max-ziplist-value`, `zset-max-ziplist-entries` or `zset-max-ziplist-value`) to a very large value, and then constructing specially crafted commands to create very large ziplists.\r\n\r\n### Patches\r\nThe problem is fixed in Redis versions 6.2.6, 6.0.16, 5.0.14.\r\n\r\n### Workarounds\r\nAn additional workaround to mitigate the problem without patching the `redis-server` executable is to prevent users from modifying the above configuration parameters. This can be done using ACL to restrict unprivileged users from using the `CONFIG SET` command.\r\n\r\n### Credit\r\nThis issue was discovered and reported by [sundb](https://github.com/sundb).\r\n\r\n### For more information\r\nIf you have any questions or comments about this advisory:\r\n* Open an issue in [the Redis repository](https://github.com/redis/redis)\r\n* Email us at redis@redis.io\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "redis",
        "purl": "pkg:dhi/redis"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.0.14"
            },
            {
              "introduced": "6.0.0"
            },
            {
              "fixed": "6.0.16"
            },
            {
              "introduced": "6.2.0"
            },
            {
              "fixed": "6.2.6"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "redis",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/redis/redis/security/advisories/GHSA-vw22-qm3h-49pr"
    }
  ]
}