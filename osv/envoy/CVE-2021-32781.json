{
  "modified": "2021-08-24T19:29:54Z",
  "published": "2021-08-24T19:29:54Z",
  "schema_version": "1.5.0",
  "id": "CVE-2021-32781",
  "aliases": [
    "GHSA-5vhv-gp9v-42qv"
  ],
  "details": "CVSS score 8.6 (High), Vector: [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H)\r\n\r\nAfter Envoy sends a locally generated response it must stop further processing of request or response data. However when local response is generated due the internal buffer overflow while request or response is processed by the filter chain the operation may not be stopped completely and result in accessing a freed memory block.\r\n\r\n### Impact\r\nDenial of Service when using extensions that modify and increase the size of request or response bodies, such as decompressor filter.\r\n\r\n### Attack Vector\r\nA specifically constructed request delivered by an untrusted downstream or upstream peer in the presence of extensions that modify and increase the size of request or response bodies.\r\n\r\n### Patches\r\nEnvoy versions 1.19.1, 1.18.4, 1.17.4, 1.16.5 contain fixes to address incomplete termination of request processing after locally generated response.\r\n\r\n### Workarounds\r\nDisable Envoy's decompressor, json-transcoder or grpc-web extensions or proprietary extensions that modify and increase the size of request or response bodies, if feasible.\r\n\r\n### Credits\r\nRaul Gutierrez Segales \u003crgs@pinterest.com\u003e\r\n\r\n### References\r\nhttps://blog.envoyproxy.io\r\nhttps://github.com/envoyproxy/envoy/releases\r\n\r\n### For more information\r\nIf you have any questions or comments about this advisory:\r\n\r\nOpen an issue in [Envoy repo](https://github.com/envoyproxy/envoy/issues)\r\nEmail us at [envoy-security](envoy-security@googlegroups.com)",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.16.4"
            },
            {
              "fixed": "1.16.5"
            },
            {
              "introduced": "1.17.3"
            },
            {
              "fixed": "1.17.4"
            },
            {
              "introduced": "1.18.3"
            },
            {
              "fixed": "1.18.4"
            },
            {
              "introduced": "1.19.0"
            },
            {
              "fixed": "1.19.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-5vhv-gp9v-42qv"
    }
  ]
}