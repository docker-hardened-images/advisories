{
  "modified": "2022-08-04T19:11:51Z",
  "published": "2022-08-04T17:23:38Z",
  "schema_version": "1.5.0",
  "id": "CVE-2022-35929",
  "aliases": [
    "GHSA-vjxv-45g9-9296"
  ],
  "details": "### Impact\r\n\r\n`cosign verify-attestation` used with the `--type` flag will report a false positive verification when:\r\n\r\n- There is at least one attestation with a valid signature\r\n- There are NO attestations of the type being verified (--type defaults to \"custom\")\r\n\r\nThis can happen when signing with a standard keypair and with \"keyless\" signing with Fulcio.\r\n\r\n### Reproduce\r\n\r\nThis vulnerability can be reproduced with  the `distroless.dev/static@sha256:dd7614b5a12bc4d617b223c588b4e0c833402b8f4991fb5702ea83afad1986e2` image.\r\n\r\nThis image has a `vuln` attestation but not an `spdx` attestation.\r\nHowever, if you run `cosign verify-attestation --type=spdx` on this image, it incorrectly succeeds:\r\n\r\n```\r\nCOSIGN_EXPERIMENTAL=true cosign verify-attestation --type spdx distroless.dev/static@sha256:dd7614b5a12bc4d617b223c588b4e0c833402b8f4991fb5702ea83afad1986e2\r\n```\r\n\r\nTo see the predicate type:\r\n\r\n```\r\n# Get the predicate type\r\nCOSIGN_EXPERIMENTAL=true cosign verify-attestation --type spdx distroless.dev/static@sha256:dd7614b5a12bc4d617b223c588b4e0c833402b8f4991fb5702ea83afad1986e2 | jq -r .payload | base64 -d | jq -r .predicateType\r\n\r\ncosign.sigstore.dev/attestation/vuln/v1\r\n```\r\n\r\n### Patches\r\n\r\nUsers should upgrade to cosign version 1.10.1 or greater for a patch.\r\n\r\n\r\n### Workarounds\r\n\r\nCurrently the only workaround is to upgrade.\r\n\r\n### For more information\r\nIf you have any questions or comments about this advisory:\r\n\r\n- Open an issue in [cosign](https://github.com/sigstore/cosign)\r\n- Send us a message on [Slack](https://sigstore.slack.com/). Invite link [here](https://join.slack.com/t/sigstore/shared_invite/zt-mhs55zh0-XmY3bcfWn4XEyMqUUutbUQ).\r\n\r\n### Thank you\r\nThank you to @mattmoor for finding and reporting this vulnerability.\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "cosign",
        "purl": "pkg:dhi/cosign"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.10.0"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "cosign",
        "source_package": "cosign"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/sigstore/cosign/security/advisories/GHSA-vjxv-45g9-9296"
    }
  ]
}