{
  "modified": "2025-09-19T10:42:16Z",
  "published": "2023-11-24T17:20:45Z",
  "schema_version": "1.5.0",
  "id": "GHSA-hfxh-rjv7-2369",
  "details": "### Summary\r\n\r\nThe `runTailscalePing` method of the `TailscalePing` class injects the `hostname` parameter inside a shell command, leading to a command injection and the possibility to run arbitrary commands on the server.\r\n\r\n### Details\r\n\r\nWhen adding a new monitor on Uptime Kuma, we can select the \"Tailscale Ping\" type. Then we can add a hostname and insert a command injection payload into it. The front-end application requires that the field follow a specific pattern, this validation only happens on the front-end and can be removed by removing the attribute `pattern` on the `input` element.\r\n\r\nhttps://github.com/louislam/uptime-kuma/blob/dc4242019331e65a79ac16deef97510144e01b12/server/monitor-types/tailscale-ping.js#L40-L46\r\n\r\nWe can finally add the new monitor and observe that our command is being executed.\r\n\r\n**NOTE:** When using Uptime Kuma inside a container, the \"TailScale Ping\" type is not visible. We can fake this information by intercepting WebSocket messages and set the `isContainer` option to `false`.\r\n\r\n### PoC\r\n\r\n* Authenticate.\r\n* Create a new monitor.\r\n* Select the TailScale Ping type (if not visible, see the note in the details section).\r\n* Insert the command injection payload inside the `hostname` field. (for example `$(id >&2)`)\r\n* Remove the `pattern` requirement on the field.\r\n* Save and start the monitor.\r\n\r\n![image](https://user-images.githubusercontent.com/112879577/284943751-b63af693-0098-4b8d-a722-2baf8ff1dacf.png)\r\n\r\n### Impact\r\n\r\nAn authenticated user can execute arbitrary command on the server running Uptime Kuma.\r\n\r\n### Remediation\r\n\r\nThere are other command execution in the codebase, they use a method `spawn` from the `child_process` module which does not interpret the command as a shell command, the same thing should be done here.\r\n\r\n**NOTE:** The Tailscale CLI seems to support the `--` sequence. It should be used between the `ping` subcommand and the `hostname` argument to avoid argument injection.",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "uptime-kuma",
        "purl": "pkg:dhi/uptime-kuma"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.23.0"
            },
            {
              "fixed": "1.23.7"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/louislam/uptime-kuma/security/advisories/GHSA-hfxh-rjv7-2369"
    }
  ],
  "withdrawn": "2025-09-19T10:42:16Z"
}
