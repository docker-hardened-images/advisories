{
  "modified": "2024-04-12T19:51:54Z",
  "published": "2024-04-12T13:07:10Z",
  "schema_version": "1.5.0",
  "id": "CVE-2024-32019",
  "aliases": [
    "GHSA-pmhq-4cxq-wj93"
  ],
  "details": "### Summary\r\nThe `ndsudo` tool shipped with affected versions of the Netdata Agent allows an attacker to run arbitrary programs with root permissions.\r\n\r\n### Details\r\nThe `ndsudo` tool is packaged as a `root`-owned executable with the SUID bit set.\r\nIt only runs a restricted set of external commands, but its search paths are supplied by the `PATH` environment variable. This allows an attacker to control where `ndsudo` looks for these commands, which may be a path the attacker has write access to.\r\n\r\n### PoC\r\nAs a user that has permission to run `ndsudo`:\r\n\r\n1. Place an executable with a name that is on `ndsudo`â€™s list of commands (e.g. `nvme`) in a writable path\r\n2. Set the `PATH` environment variable so that it contains this path\r\n3. Run `ndsudo` with a command that will run the aforementioned executable\r\n\r\n### Impact\r\n\r\nLocal privilege escalation.",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "netdata",
        "purl": "pkg:dhi/netdata"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.44.0-60"
            },
            {
              "fixed": "1.45.0-169"
            },
            {
              "introduced": "1.45.0"
            },
            {
              "fixed": "1.45.3"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/netdata/netdata/security/advisories/GHSA-pmhq-4cxq-wj93"
    }
  ]
}