{
  "modified": "2024-06-28T23:41:36Z",
  "published": "2024-06-28T23:41:36Z",
  "schema_version": "1.5.0",
  "id": "CVE-2024-39305",
  "aliases": [
    "GHSA-fp35-g349-h66f"
  ],
  "details": "### Summary\r\nEnvoy references already freed memory when route hash policy is configured with cookie attributes.  \r\nNote that this vulnerability has been fixed in the open as the effect would be immediately apparent if it was configured. \r\n\r\n### Affected Components\r\nEnvoy request routing table.\r\n\r\n### Details\r\nMemory allocated for holding attribute values is freed after configuration was parsed. During request processing Envoy will attempt to copy content of de-allocated memory into request cookie header. This can lead to arbitrary content of Envoy's memory to be sent to the upstream service or abnormal process termination.\r\n\r\n### Impact\r\nInformation disclosure or denial of service due to abnormal process termination.\r\n\r\n### Attack vector(s)\r\nA request from an untrusted peer.\r\n\r\n### Patches\r\nThis vulnerability is fixed in Envoy versions v1.30.4, v1.29.7, v1.28.5 or v1.27.7\r\n\r\n### Workarounds\r\nDo not use cookie attributes in route action hash policy.\r\n\r\n### Detection\r\nUnexpected characters in the cookie header at the upstream service or abnormal process termination with route hash policy methods in the stack trace.\r\n\r\n### Credits\r\n[mregxn@gmail.com](http://mregxn@gmail.com/)",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "database_specific": {
        "range_status": "error parsing fixed versions: error sanitizing version: invalid version: or.0",
        "source_ecosystem": "envoy proxy",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-fp35-g349-h66f"
    }
  ]
}