{
  "modified": "2020-07-30T13:28:36Z",
  "published": "2020-07-30T13:28:36Z",
  "schema_version": "1.5.0",
  "id": "CVE-2020-15129",
  "aliases": [
    "GHSA-6qq8-5wq3-86rp"
  ],
  "details": "## Summary\r\n\r\nThere exists a potential open redirect vulnerability in Traefik's handling of the `X-Forwarded-Prefix` header. Active Exploitation of this issue is unlikely as it would require active header injection, however the Traefik team addressed this issue nonetheless to prevent abuse in e.g. cache poisoning scenarios.\r\n\r\n## Details\r\n\r\nThe Traefik API dashboard component doesn't validate that the value of the header `X-Forwarded-Prefix` is a site relative path and will redirect to any header provided URI.\r\n\r\ne.g.\r\n\r\n```\r\n$ curl --header 'Host:traefik.localhost' --header 'X-Forwarded-Prefix:https://example.org' 'http://localhost:8081'\r\n\u003ca href=\"https://example.org/dashboard/\"\u003eFound\u003c/a\u003e.`\r\n```\r\n\r\n### Impact\r\nA successful exploitation of an open redirect can be used to entice victims to disclose sensitive information.\r\n\r\n### Patches\r\n\r\n- Traefik v1.x: https://github.com/containous/traefik/releases/tag/v1.7.26\r\n- Traefik v2.2.x: https://github.com/containous/traefik/releases/tag/v2.2.8\r\n- Traefik v2.3.x: https://github.com/containous/traefik/releases/tag/v2.3.0-rc3\r\n\r\n### Workarounds\r\n\r\nBy using the `headers` middleware, the request header `X-Forwarded-Prefix` value can be overridden by the value `.` (dot)\r\n\r\n- https://docs.traefik.io/v2.2/middlewares/headers/#customrequestheaders\r\n- https://docs.traefik.io/v1.7/basics/#custom-headers\r\n\r\n\u003cdetails\u003e\u003csummary\u003eexample: docker-compose.yml\u003c/summary\u003e\r\n\r\n```yaml\r\n# curl -k -L --header 'X-Forwarded-Prefix:https://whoami.localhost' https://traefik.localhost\r\n\r\nversion: '3.7'\r\n\r\nservices:\r\n\r\n  traefik:\r\n    image: traefik:v2.2.7\r\n    command:\r\n      - --api\r\n      - --providers.docker.exposedbydefault=false\r\n      - --entrypoints.web.address=:80\r\n      - --entrypoints.web.http.redirections.entrypoint.to=websecure\r\n      - --entrypoints.web.http.redirections.entrypoint.scheme=https\r\n      - --entrypoints.websecure.address=:443\r\n      - --entrypoints.websecure.http.tls=true\r\n    ports:\r\n      - 80:80\r\n      - 443:443\r\n    volumes:\r\n      - /var/run/docker.sock:/var/run/docker.sock:ro\r\n    labels:\r\n      traefik.enable: 'true'\r\n\r\n      # Dashboard\r\n      traefik.http.routers.traefik.rule: Host(`traefik.localhost`)\r\n      traefik.http.routers.traefik.entrypoints: websecure\r\n      traefik.http.routers.traefik.service: api@internal\r\n      traefik.http.routers.traefik.middlewares: clean\r\n\r\n      traefik.http.middlewares.clean.headers.customrequestheaders.X-Forwarded-Prefix: .\r\n\r\n  whoami:\r\n    image: containous/whoami:v1.5.0\r\n    labels:\r\n      traefik.enable: 'true'\r\n\r\n      traefik.http.routers.app.rule: Host(`whoami.localhost`)\r\n      traefik.http.routers.app.entrypoints: websecure\r\n```\r\n\r\n\u003c/details\u003e\r\n\r\n### For more information\r\n\r\nIf you have any questions or comments about this advisory, open an issue in [Traefik](https://github.com/containous/traefik/issues).\r\n\r\n## Credit\r\n\r\nThis issue was found by the GitHub Application Security Team and reported on behalf of the GHAS by the GitHub Security Lab Team.",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "traefik",
        "purl": "pkg:dhi/traefik"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.7.26"
            },
            {
              "introduced": "2.0.0"
            },
            {
              "fixed": "2.2.8"
            },
            {
              "introduced": "2.3.0"
            },
            {
              "fixed": "2.3.0-rc3"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/traefik/traefik/security/advisories/GHSA-6qq8-5wq3-86rp"
    }
  ]
}