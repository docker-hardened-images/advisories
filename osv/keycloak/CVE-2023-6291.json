{
  "modified": "2023-12-19T21:02:33Z",
  "published": "2023-12-19T21:02:33Z",
  "schema_version": "1.5.0",
  "id": "CVE-2023-6291",
  "aliases": [
    "GHSA-mpwq-j3xf-7m5w"
  ],
  "details": "An issue was found in the redirect_uri validation logic that allows for a bypass of otherwise explicitly allowed hosts.\r\n\r\nThe problem arises in the verifyRedirectUri method, which attempts to enforce rules on user-controllable input, but essentially causes a desynchronization in how Keycloak and browsers interpret URLs. Keycloak, for example, receives \"[www%2ekeycloak%2eorg%2fapp%2f:y@example.com](https://www%2ekeycloak%2eorg%2fapp%2f:y@example.com/)\" and thinks the authority to be keycloak.org when it is actually example.com. This happens because the validation logic is performed on a URL decoded version, which no longer represents the original input.\r\n\r\n### Acknowledgements\r\nKarel Knibbe ",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "keycloak",
        "purl": "pkg:dhi/keycloak"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "23.0.3"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "maven",
        "source_package": "org.keycloak.protocol.oidc"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/keycloak/keycloak/security/advisories/GHSA-mpwq-j3xf-7m5w"
    }
  ]
}