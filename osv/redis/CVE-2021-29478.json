{
  "modified": "2021-05-03T20:26:57Z",
  "published": "2021-05-03T20:26:57Z",
  "schema_version": "1.5.0",
  "id": "CVE-2021-29478",
  "aliases": [
    "GHSA-qh52-crrg-44g3"
  ],
  "details": "### Impact\r\nAn integer overflow bug in Redis 6.2 could be exploited to corrupt the heap and potentially result with remote code execution.\r\n\r\nThe vulnerability involves changing the default `set-max-intset-entries` configuration value, creating a large set key that consists of integer values and using the `COPY` command to duplicate it.\r\n\r\nThe integer overflow bug exists in all versions of Redis starting with 2.6, where it could result with a corrupted RDB or DUMP payload, but not exploited through `COPY` (which did not exist before 6.2).\r\n\r\n### Patches\r\nThe problem is fixed in version 6.2.3.\r\n\r\nRedis 6.0 and earlier are not directly affected by this issue but should be upgraded as they are potentially vulnerable to other issues due to lack of RDB and RESTORE payload sanitization, which was introduced in 6.2.0.\r\n\r\n### Workarounds\r\nAn additional workaround to mitigate the problem without patching the `redis-server` executable is to prevent users from modifying the `set-max-intset-entries` configuration parameter. This can be done using ACL to restrict unprivileged users from using the `CONFIG SET` command.\r\n\r\n### For more information\r\nIf you have any questions or comments about this advisory:\r\n* Open an issue in [the Redis repository](https://github.com/redis/redis)\r\n* Email us at redis@redis.io\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "redis",
        "purl": "pkg:dhi/redis"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "6.2.0"
            },
            {
              "fixed": "6.2.3"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/redis/redis/security/advisories/GHSA-qh52-crrg-44g3"
    }
  ]
}