{
  "modified": "2021-08-24T19:29:45Z",
  "published": "2021-08-24T19:29:45Z",
  "schema_version": "1.5.0",
  "id": "CVE-2021-32778",
  "aliases": [
    "GHSA-3xh3-33v5-chcc"
  ],
  "details": "CVSS score 8.6 (High), Vector: [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L)\r\n\r\nEnvoyâ€™s procedure for resetting a HTTP/2 stream has O(N^2) complexity, leading to high CPU utilization when a large number of streams are reset.\r\n\r\n### Impact\r\nDenial of Service when Envoy is configured with high limit on HTTP/2 concurrent streams.\r\n\r\n### Attack vector\r\nA client opening and closing a large number of HTTP/2 streams.\r\n\r\n### Patches\r\nEnvoy versions 1.19.1, 1.18.4, 1.17.4 contain fixes to reduce time complexity of resetting HTTP/2 streams.\r\n\r\n**IMPORTANT:** Due to significant divergence in affected source code between Envoy versions 1.16 and 1.17 it is not feasible to backport the fix into the the 1.16 stable branch without increasing the risk of destabilizing it. As a result operators of Envoy version 1.16 are recommended to apply workaround listed below. See [recommended edge settings](https://www.envoyproxy.io/docs/envoy/v1.16.3/configuration/best_practices/edge) for instructions about changing this setting.\r\n\r\n### Workarounds\r\nLimit the number of simultaneous HTTP/2 streams for upstream and downstream peers to a low number, i.e. 10.\r\n\r\n### Credits\r\nNikolas Koutounidis \u003ckoutounidis.nikolaos@gmail.com\u003e\r\n\r\n### References\r\nhttps://blog.envoyproxy.io\r\nhttps://github.com/envoyproxy/envoy/releases\r\n\r\n### For more information\r\nIf you have any questions or comments about this advisory:\r\n\r\nOpen an issue in [Envoy repo](https://github.com/envoyproxy/envoy/issues)\r\nEmail us at [envoy-security](envoy-security@googlegroups.com)",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.16.4"
            },
            {
              "fixed": "1.17.4"
            },
            {
              "introduced": "1.18.3"
            },
            {
              "fixed": "1.18.4"
            },
            {
              "introduced": "1.19.0"
            },
            {
              "fixed": "1.19.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-3xh3-33v5-chcc"
    }
  ]
}