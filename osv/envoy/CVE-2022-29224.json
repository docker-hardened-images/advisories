{
  "modified": "2022-06-09T16:12:32Z",
  "published": "2022-06-09T16:12:32Z",
  "schema_version": "1.5.0",
  "id": "CVE-2022-29224",
  "aliases": [
    "GHSA-m4j9-86g3-8f49"
  ],
  "details": "# Attack type\r\nRemote\r\n\r\n# Impact\r\nDenial of service\r\n\r\n# Affected component(s)\r\ngRPC health checking\r\n\r\n# Attack vector(s)\r\nRemote, upstream hosts \r\n\r\n# Discoverer(s)/Credits\r\nErik Lindblad \u003cerili@spotify.com\u003e\r\n\r\n# Description (brief; included in CVE)\r\nAn attacker-controlled upstream server that is health checked using gRPC health checking can crash Envoy via a null pointer dereference in certain circumstances.\r\n\r\n# Example exploit or proof-of-concept\r\n1. Attacker controls an upstream server that is health checked using gRPC\r\n2. Server is known to Envoy via service discovery (EDS, DNS, etc.)\r\n3. Envoy is configured to not remove upstream hosts until health check fails\r\n4. Attacker causes Envoy to mark the host for removal (remove from DNS, remove from EDS via some out of band mechanism, etc.)\r\n5. Attacker causes the upstream host to fail the gRPC health check.\r\n6. Envoy will crash.\r\n\r\n# Description (full; not included in CVE but will be published on GitHub later and linked)\r\nEnvoy can perform various types of upstream health checking. One of them uses gRPC. Envoy also has a feature which can “hold” (prevent removal) upstream hosts obtained via service discovery until configured active health checking fails.\r\n\r\nIf an attacker controls an upstream host and also controls service discovery of that host (via DNS, the EDS API, etc.), an attacker can crash Envoy by forcing removal of the host from service discovery, and then failing the gRPC health check request. This will crash Envoy via a null pointer dereference.\r\n\r\n# Mitigation\r\nDisable gRPC health checking and/or replace it with a different health checking type.\r\n\r\n# Detection\r\nCrashes with call stacks in the gRPC health checking code.\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.22.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "envoy",
        "source_package": "Envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-m4j9-86g3-8f49"
    }
  ]
}