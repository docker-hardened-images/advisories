{
  "modified": "2025-09-12T13:11:27Z",
  "published": "2019-12-10T18:35:57Z",
  "schema_version": "1.5.0",
  "id": "CVE-2019-18802",
  "aliases": [
    "GHSA-356m-vhw2-wcm4"
  ],
  "details": "# CVE-1019-18802\r\n\r\n## Brief description\r\n\r\nA request header with trailing whitespace may cause route matchers or access controls to be bypassed, resulting in escalation of privileges or information disclosure.\r\n\r\n## CVSS\r\n\r\n[CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)\r\n(CVSS score 7.5, High)\r\n\r\n## Affected version(s)\r\n\r\nEnvoy 1.12.1 and before.\r\n\r\n## Affected component(s)\r\n\r\nHTTP/1.x codec\r\n\r\n## Attack vector(s)\r\n\r\nAn untrusted remote client may send an HTTP headers, for example a Host: header with whitespace after the header content.  Envoy will treat “header-value “ as a different string from “header-value” so for example with the host header “hostname.com “ would bypass matchers for “hostname.com”.\r\n\r\n## Discover(s)/Credits\r\n\r\nAlyssa Wilk, Google\r\n\r\n## Details\r\n\r\nThe parser in Envoy’s HTTP/1 codec incorrectly fails to trim whitespace after header values.  This results in obvious security problems for multi-level deployments where an edge Envoy has matchers for “my-super-secret-content.com” to direct reply from the edge Envoy, and will fail to match “my-super-secret-content.com “ (with trailing LWS) which would be proxied to a second level proxy which (if it is properly HTTP/1.1 compliant) will strip the whitespace and leak privileged content.  \r\n\r\n## Mitigations\r\n\r\n*   Disable upstream HTTP/1.\r\n\r\n## Detection\r\n\r\nThe untrimmed hosts will be present in access logs.\r\n\r\n## References\r\n\r\n* https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18802",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.12.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-356m-vhw2-wcm4"
    }
  ]
}