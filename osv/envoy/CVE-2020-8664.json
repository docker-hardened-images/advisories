{
  "modified": "2020-03-03T18:05:04Z",
  "published": "2020-03-03T18:05:04Z",
  "schema_version": "1.5.0",
  "id": "CVE-2020-8664",
  "aliases": [
    "GHSA-3x9m-pgmg-xpx8"
  ],
  "details": "## Vulnerability type\r\n\r\nIncorrect Access Control\r\n\r\n## Attack type\r\n\r\nImpersonation\r\n\r\n## Impact\r\n\r\nEscalation of Privileges\r\nUnauthorized access to service, service spoofing\r\n\r\n## Discoverer(s)/Credits\r\n\r\nAndon Andonov (Microsoft)\r\nRyan Michela (Salesforce)\r\nScott Beardsley (Pinterest)\r\nJasper Misset (Visma Connect)\r\n\r\n## Description (full; not included in CVE but will be published on GitHub later and linked)\r\n\r\nFor the SDS TLS validation context in Envoy version 1.13.0 and earlier, the update callback was called only when the secret was received for the first time or when its value changed. This meant that if the same secret (e.g. trusted CA) was used in multiple resources, then resources using it but configured after the secret was already received, remained unconfigured until the secret's value changed. The missing callback should have resulted in transport factories stuck in the \"not ready\" state, however, because of an incorrect code, the available secret was processed like inlined validation context, and only rules from the dynamic (\"secret\") part of the validation context were applied, leading to a complete bypass of rules from the static (\"default\") part.\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.12.3"
            },
            {
              "introduced": "1.13.0"
            },
            {
              "fixed": "1.13.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": "Envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-3x9m-pgmg-xpx8"
    }
  ]
}