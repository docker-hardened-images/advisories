{
  "modified": "2023-04-04T14:50:07Z",
  "published": "2023-04-04T14:50:07Z",
  "schema_version": "1.5.0",
  "id": "CVE-2023-27487",
  "aliases": [
    "GHSA-5375-pq35-hf2g"
  ],
  "details": "### Impact\r\n\r\nBypass JWT checks, forge fake original paths.\r\n\r\n### Affected components\r\n\r\nTrace logs, gRPC logs, JWT filter.\r\n\r\n### Attack vector/s\r\n\r\nThe header `x-envoy-original-path` should be an internal header, but Envoy does not remove this header from the request at the beginning of request processing when it is sent from an untrusted client.  \r\n\r\nThe faked header would then be used for trace logs and grpc logs, as well as used in the URL used for `jwt_authn` checks if the `jwt_authn` filter is used, and any other upstream use of the x-envoy-original-path header.\r\n\r\n### Description\r\n\r\nTrusted `x-envoy-original-path` header can be forged by attackers\r\n\r\n\r\n### Example exploit or proof-of-concept\r\n\r\nClient request:\r\n\r\n```console\r\n$ curl -H \"x-envoy-original-path: /fake\" http://localhost:8080/real-path/\r\n```\r\n\r\nAccess log, using the default log format:\r\n\r\n```console\r\n[2023-02-28T19:26:53.660Z] \"GET /fake HTTP/1.1\" 200 - 0 3257 1 0 \"-\" \"curl/7.82.0\" \"36174006-b793-4e40-8a38-a3d17a2a37a0\" \"localhost:8080\" \"172.18.98.50:8020\"\r\n```\r\n\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.22.9"
            },
            {
              "introduced": "1.23.0"
            },
            {
              "fixed": "1.23.6"
            },
            {
              "introduced": "1.24.0"
            },
            {
              "fixed": "1.24.4"
            },
            {
              "introduced": "1.25.0"
            },
            {
              "fixed": "1.25.3"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "envoy",
        "source_package": "Envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-5375-pq35-hf2g"
    }
  ]
}