{
  "modified": "2025-09-02T15:18:29Z",
  "published": "2025-09-02T15:18:29Z",
  "schema_version": "1.5.0",
  "id": "CVE-2025-55162",
  "aliases": [
    "GHSA-95j4-hw7f-v2rh"
  ],
  "details": "### Summary\r\nInsufficient Session Expiration in the Envoy OAuth2 filter leads to failed logout operations. When configured with `__Secure-` or `__Host-` prefixed cookie names, the filter fails to append the required `Secure` attribute to the `Set-Cookie` header during deletion. Modern browsers ignore this invalid request, causing the session cookie to persist. This allows a user to remain logged in after they believe they have logged out, creating a session hijacking risk on shared computers.\r\n\r\n### Details\r\nCookies with the` __Secure-` or `__Host-` prefix MUST be set with the Secure attribute. This requirement extends to cookie deletion, which is accomplished by setting an expired Set-Cookie header.\r\n\r\nThe current implementation iterates through the configured cookie names to generate deletion headers but does not check for these prefixes. As a result, when it attempts to delete a cookie named, for example, `__Secure-id-token`, it generates a header like:\r\n\r\n`Set-Cookie: __Secure-id-token=deleted; Expires=Thu, 01 Jan 1970 00:00:00 GMT`\r\n\r\nThis is incorrect. The browser will reject this instruction because the Secure attribute is missing. The correct header should be:\r\n\r\n`Set-Cookie: __Secure-id-token=deleted; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Secure`\r\n\r\nThis failure to properly construct the deletion header means the user's session cookies are never removed by the browser, leaving the session active.\r\n\r\n### PoC\r\n1. Has any of the following configs like:\r\n```\r\n- name: envoy.filters.http.oauth2\r\n  typed_config:\r\n    \"@type\": type.googleapis.com/envoy.extensions.filters.http.oauth2.v3.OAuth2\r\n    ...\r\n    cookie_names:\r\n      bearer_token: \"__Secure-bearer\"\r\n      oauth_hmac: \"__Secure-hmac\"\r\n      id_token: \"__Secure-id-token\"\r\n      refresh_token: \"__Secure-refresh-token\"\r\n    ...\r\n```\r\n\r\n2. log-in\r\n3. log-out, the cookie will not be deleted\r\n\r\n### Impact\r\nIt impacts any environment using Envoy's OAuth2 filter where cookie names have been configured with `__Secure-` or `__Host-` prefixes. The primary risk is session hijacking in scenarios involving shared or public computers. A user who performs a logout action will be led to believe their session is terminated. However, the session remains active, allowing the next user of the same browser to gain unauthorized access to the original user's account and data.\r\n\r\n### Mitigation\r\n* Avoid the `__Secure-` or `__Host-` config\r\n* Apply the fix patch\r\n\r\n### Reporter:\r\n\r\n Thomas Br√ºggemann \u003cbruegth@gmail.com\u003e\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.32.10"
            },
            {
              "introduced": "1.33.0"
            },
            {
              "fixed": "1.33.7"
            },
            {
              "introduced": "1.34.0"
            },
            {
              "fixed": "1.34.5"
            },
            {
              "introduced": "1.35.0"
            },
            {
              "fixed": "1.35.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": "Envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-95j4-hw7f-v2rh"
    }
  ]
}