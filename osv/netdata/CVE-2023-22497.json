{
  "modified": "2023-01-13T22:27:32Z",
  "published": "2022-12-01T16:53:42Z",
  "schema_version": "1.5.0",
  "id": "CVE-2023-22497",
  "aliases": [
    "GHSA-jx85-39cw-66f2"
  ],
  "details": "### Impact\r\n\r\nEach Netdata Agent has an automatically generated MACHINE GUID. It is generated when the agent first starts and it is saved to disk, so that it will persist across restarts and reboots. Anyone who has access to a Netdata Agent has access to its MACHINE_GUID.\r\n\r\nStreaming is a feature that allows a Netdata Agent to act as parent for other Netdata Agents (children), offloading children from various functions (increased data retention, ML, health monitoring, etc) that can now be handled by the parent Agent.\r\n\r\nConfiguration is done via `stream.conf`. On the parent side, users configure in `stream.conf` an API key (any random UUID can do) to provide common configuration for all children using this API key and per MACHINE GUID configuration to customize the configuration for each child.\r\n\r\nThe way this was implemented, allowed an attacker to use a valid MACHINE_GUID as an API key.\r\n\r\nThis affects all users who expose their Netdata Agents (children) to non-trusted users and they also expose to the same users Netdata Agent parents that aggregate data from all these children.\r\n\r\n### Patches\r\n\r\nThe problem has been fixed in:\r\n\r\n- Netdata agent v1.37 (stable)\r\n- Netdata agent v1.36.0-409 (nightly)\r\n\r\n### Workarounds\r\n\r\nStreaming is not enabled by default. If you have previously enabled this, it can be disabled by modifying `stream.conf`:\r\n\r\n```\r\n[stream]\r\n    enabled = no\r\n```\r\n\r\nLimiting access to the port on the recipient Agent to trusted child connections may mitigate the impact of this vulnerability.\r\n\r\n### References\r\n\r\n- Documentation on [streaming and replication](https://learn.netdata.cloud/docs/agent/streaming)\r\n\r\n### For more information\r\n\r\nIf you have any questions or comments about this advisory:\r\n* Open an issue in [netdata/netdata](https://github.com/netdata/netdata)\r\n* Email us at [security@netdata.cloud](mailto:security@netdata.cloud)\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "netdata",
        "purl": "pkg:dhi/netdata"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.37.0"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": "netdata"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/netdata/netdata/security/advisories/GHSA-jx85-39cw-66f2"
    }
  ]
}