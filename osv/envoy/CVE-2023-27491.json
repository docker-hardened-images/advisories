{
  "modified": "2023-04-04T14:50:01Z",
  "published": "2023-04-04T14:50:01Z",
  "schema_version": "1.5.0",
  "id": "CVE-2023-27491",
  "aliases": [
    "GHSA-5jmv-cw9p-f9rp"
  ],
  "details": "### Impact\r\n\r\nCompliant HTTP/1 service should reject malformed request lines.\r\n\r\nThere is a possibility that non compliant HTTP/1 service may allow malformed requests, potentially leading to a bypass of security policies.\r\n\r\n### Affected components\r\n\r\nHTTP2/HTTP3.\r\n\r\n### Attack vector/s\r\n\r\nAttackers can send specifically crafted HTTP/2 or HTTP/3 requests to trigger parsing errors on HTTP/1 upstream service.\r\n\r\n### Description\r\n\r\nEnvoy does not reject HTTP/2 and HTTP/3 requests with the `:method` value which is not a valid token defined in https://www.rfc-editor.org/rfc/rfc9110#section-5.6.2.\r\n\r\nIn addition to the above,  based on https://datatracker.ietf.org/doc/html/rfc9113#section-8.3 and https://datatracker.ietf.org/doc/html/rfc9114#section-4.3.1, HTTP/2 and HTTP/3 requests **MUST** include exactly one value for the `:method`, `:scheme`, and `:path` pseudo-header fields, unless the request is a `CONNECT` request which may omit `:scheme` and `:path`.\r\n\r\nAllowing invalid characters in pseudo headers can result in sending an invalid request line when proxying from HTTP/2 or HTTP/3 client to HTTP/1 upstream service.\r\n\r\n### Example exploit or proof-of-concept\r\n\r\nSend an HTTP/2 or HTTP/3 request with invalid `:method` header such as  `:method: GET /admin`. \r\n\r\n### Detection\r\n\r\nUpstream service receives unexpected privileged requests from Envoy.\r\n\r\n### Discoverer(s)/Credits\r\n\r\nMartin van Kervel Smedshammer \u003cmvsmedsh@ifi.uio.no\u003e\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.22.9"
            },
            {
              "introduced": "1.23.0"
            },
            {
              "fixed": "1.23.6"
            },
            {
              "introduced": "1.24.0"
            },
            {
              "fixed": "1.24.4"
            },
            {
              "introduced": "1.25.0"
            },
            {
              "fixed": "1.25.3"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "envoy",
        "source_package": "Envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-5jmv-cw9p-f9rp"
    }
  ]
}