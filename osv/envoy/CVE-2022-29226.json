{
  "modified": "2022-06-09T16:12:44Z",
  "published": "2022-06-09T16:12:44Z",
  "schema_version": "1.5.0",
  "id": "CVE-2022-29226",
  "aliases": [
    "GHSA-h45c-2f94-prxh"
  ],
  "details": "# Attack type\r\nRemote\r\n\r\n# Impact\r\nUnauthorized access to endpoints protected by oauth.\r\n\r\n# Affected component(s)\r\nOauth protected endpoints. \r\n\r\n# Attack vector(s)\r\nAny endpoint that’s supposed to be protected by the oauth filter. \r\n\r\n# Discoverer(s)/Credits\r\nWeiqiu Wen [ff800u@gmail.com](mailto:ff800u@gmail.com) \r\n\r\n# Description (brief; included in CVE)\r\nThe OAuth filter implementation does not include a mechanism for validating access tokens, so by design when the HMAC signed cookie is missing a full authentication flow should be triggered. However, the current implementation assumes that access tokens are always validated thus allowing access in the presence of any access token attached to the request.\r\n\r\n# Example exploit or proof-of-concept\r\n\r\n```\r\ncurl -v -H 'Authorization:Bearer asdfasdfasdfasd' https://\u003cmy-service\u003e\r\n```\r\n\r\n# Description (full; not included in CVE but will be published on GitHub later and linked)\r\nThe OAuth specification allows for authorization flows to be skipped as long as a valid token is present. However, validating the token is implementation specific and no such process is included within the Envoy’s open source implementation (private implementations do indeed validate the access token). This means that access tokens should be ignored and only the HMAC signed cookie should be used for authentication. \r\n\r\n# Mitigation\r\nNone. \r\n\r\n# Detection\r\nImproper access in the access logs.",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.22.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "envoy",
        "source_package": "Envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-h45c-2f94-prxh"
    }
  ]
}