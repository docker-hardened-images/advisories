{
  "modified": "2023-01-26T08:57:22Z",
  "published": "2023-01-26T08:57:22Z",
  "schema_version": "1.5.0",
  "id": "CVE-2022-23552",
  "aliases": [
    "GHSA-8xmm-x63g-f6xv"
  ],
  "details": "### Description \r\nOn 2022-12-16 during an internal audit of Grafana, a member of the security team found a stored XSS vulnerability affecting the core plugin GeoMap.\r\n\r\nThe stored XSS vulnerability was possible due to SVG-files weren't properly sanitized and allowed arbitrary JavaScript to be executed in the context of the currently authorized user of the Grafana instance. \r\n\r\n### Impact\r\nAn attacker needs to have the Editor role in order to change a panel to include either an external URL to a SVG-file containing JavaScript, or use the `data:` scheme to load an inline SVG-file containing JavaScript. This means that vertical privilege escalation is possible, where a user with Editor role can change to a known password for a user having Admin role if the user with Admin role executes malicious JavaScript viewing a dashboard.   \r\n\r\n### Impacted versions\r\nAll installations for Grafana versions \u003e=8.1.x.\r\n\r\n### Solutions and mitigations\r\nUpdate your Grafana instance.\r\n\r\n\r\n## Reporting security issues\r\n\r\nIf you think you have found a security vulnerability, please send a report to security@grafana.com. This address can be used for all of Grafana Labs' open source and commercial products (including, but not limited to Grafana, Grafana Cloud, Grafana Enterprise, and grafana.com). We can accept only vulnerability reports at this address. We would prefer that you encrypt your message to us by using our PGP key. The key fingerprint is\r\n\r\nF988 7BEA 027A 049F AE8E 5CAA D125 8932 BE24 C5CA\r\n\r\nThe key is available from keyserver.ubuntu.com.\r\n\r\n## Security announcements\r\n\r\nWe maintain a [security category](https://community.grafana.com/c/support/security-announcements) on our blog, where we will always post a summary, remediation, and mitigation details for any patch containing security fixes.\r\n\r\nYou can also subscribe to our [RSS feed](https://grafana.com/tags/security/index.xml).",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "grafana",
        "purl": "pkg:dhi/grafana"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/grafana/grafana/security/advisories/GHSA-8xmm-x63g-f6xv"
    }
  ]
}