{
  "modified": "2023-09-12T18:36:08Z",
  "published": "2023-09-12T18:36:08Z",
  "schema_version": "1.5.0",
  "id": "CVE-2023-4918",
  "aliases": [
    "GHSA-5q66-v53q-pm35"
  ],
  "details": "A flaw was discovered in Keycloak Core package.  When a user registers itself through registration flow, the \"password\" and \"password-confirm\" field from the form will occur as regular attributes in the users attributes. The password is also created, but the user attributes must not be there. This way, any entities (all users and clients with proper rights/roles) are able to retrieve the users passwords in clear-text. \r\n\r\n### Impact\r\nPasswords for self-registered users are stored as cleartext attributes associated with the user. \r\n\r\n### Mitigation\r\nDisable self-registration for users in all realms until patched.\r\n\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "keycloak",
        "purl": "pkg:dhi/keycloak"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "22.0.2"
            },
            {
              "fixed": "22.0.3"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "maven",
        "source_package": "org.keycloak.userprofile"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/keycloak/keycloak/security/advisories/GHSA-5q66-v53q-pm35"
    }
  ]
}