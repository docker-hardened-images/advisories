{
  "modified": "2019-08-14T18:53:48Z",
  "published": "2019-08-14T18:53:48Z",
  "schema_version": "1.5.0",
  "id": "CVE-2019-15052",
  "aliases": [
    "GHSA-4cwg-f7qc-6r95"
  ],
  "details": "## Important security update in Gradle 5.6\r\n\r\nGradle 5.6 contains an important security update for some users. \r\n\r\nThank you to [Uriah Carpenter](https://github.com/uriahcarpenter) for reporting this issue to us.\r\n\r\n### What kind of vulnerability is it? Who is impacted?\r\n\r\nThis is an information disclosure vulnerability ([CWE-522: Insufficiently Protected Credentials](https://cwe.mitre.org/data/definitions/522.html)) for the Gradle Build tool. This is tracked by [CVE-2019-15052](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15052).\r\n\r\nAnyone using the Gradle build tool to resolve dependencies against a custom authenticated repository may be vulnerable. Gradle may leak authentication data to third parties.\r\n\r\nWhen authenticating to a repository host, Gradle sends authentication headers first to the host in the initial repository URL, but in the case of a redirect (30X HTTP response code), Gradle also sends the authentication headers to the redirect host. Authentication headers often contain privacy sensitive information or data that could allow others to impersonate the user.\r\n\r\nWe are not aware of any exploits of this flaw.  \r\n\r\n### Am I Vulnerable?\r\n\r\nBelow are a few scenarios to help users determine if they are vulnerable.\r\n\r\nYou are vulnerable if and only if the repository Gradle uses requires authentication to access _AND_ the repository redirects your requests to another host out of your control.\r\n\r\n#### Using a Built-In Repository\r\n\r\nIf you are only using public repositories like `mavenCentral()`, `jcenter()`, `gradlePluginPortal()`, or `google()` you are **not vulnerable**.\r\n\r\nExample:\r\n\r\n```groovy\r\nrepositories {\r\n    mavenCentral()\r\n}\r\n```\r\n\r\n#### Using a Custom Repository\r\n\r\nIf you are using a custom repository that does not require authentication, you are **not vulnerable**.\r\n\r\nExample:\r\n\r\n```groovy\r\n// Maven\r\nrepositories {\r\n    maven {\r\n        url = \"https://public-repository.some-company.example/repo\"\r\n    }\r\n}\r\n\r\n// Ivy\r\nrepositories {\r\n    ivy {\r\n        url = \"https://public-repository.some-company.example/repo\"\r\n    }\r\n}\r\n```\r\n\r\n#### Using a Custom Repository with Credentials\r\n\r\nIf you are using a custom repository that requires credentials you **may be vulnerable**.\r\n\r\n```groovy\r\n// Maven\r\nrepositories {\r\n    maven {\r\n        url = \"https://repository.some-company.example/repo\"\r\n        credentials {\r\n            // We don't recommend hard coding credentials, this is just an example\r\n            username \"my-user-name\"\r\n            password \"my-password\"\r\n        }\r\n    }\r\n}\r\n\r\n// Ivy\r\nrepositories {\r\n    ivy {\r\n        url = \"https://repository.some-company.example/repo\"\r\n        credentials {\r\n            // We don't recommend hard coding credentials, this is just an example\r\n            username \"my-user-name\"\r\n            password \"my-password\"\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nIn the above example, if the repository hosted on `some-company.example` redirects to host `another-company.example`, Gradle will erroneously send the authentication information for `some-company.example` to `another-company.example` too. The behavior of this depends on how the repository at `some-company.example` is configured.\r\n\r\n### Has the problem been patched? What versions should users upgrade to?\r\n\r\n[Gradle 5.6](https://docs.gradle.org/5.6/release-notes.html) has been patched to fix this issue. \r\n\r\n### I can't upgrade. Is there anything I can do?\r\n\r\nUnfortunately, this vulnerability is in the Gradle codebase and there are no simple flags to disable this behavior. \r\n\r\nIf you are affected by this vulnerability and cannot upgrade, we recommend that you do not proxy external repositories from the same repository that requires authentication. \r\n\r\nIn the example below, if `repository.some-company.example/repo` serves your organization's internal artifacts as well as proxies Maven Central via redirects, you would be vulnerable. To workaround the vulnerability, you can configure your repository to no longer proxy Maven Central and split your repository declaration into two repositories:\r\n\r\n```groovy\r\n// NOTE: Maven or Ivy would work for this\r\nrepositories {\r\n    maven {\r\n        url = \"https://repository.some-company.example/repo\"\r\n        credentials {\r\n            // We don't recommend hard coding credentials, this is just an example\r\n            username \"my-user-name\"\r\n            password \"my-password\"\r\n        }\r\n    }\r\n    mavenCentral()\r\n}\r\n```\r\n\r\nSince your custom repository no longer redirects to another host, Gradle will not send authentication headers to other hosts.\r\n\r\nAlternatively, if you trust the repositories that your repository redirects to, you can continue to use an older version of Gradle and follow good security practices:\r\n- Do not share the credentials for your repository with any other critical service\r\n- Prevent remote access from outside your organization to your repository via network configuration\r\n\r\n### For more information\r\n\r\nFor security related issues, please email us at [security@gradle.com](mailto:security@gradle.com).\r\n\r\nFor non-security related issues, please open an issue on [Github](https://github.com/gradle/gradle/issues/new/choose).",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "gradle",
        "purl": "pkg:dhi/gradle"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.6.0"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "java, android, c/c++, build tooling",
        "source_package": "Gradle"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/gradle/gradle/security/advisories/GHSA-4cwg-f7qc-6r95"
    }
  ]
}