{
  "modified": "2021-05-11T19:01:42Z",
  "published": "2021-05-11T19:01:42Z",
  "schema_version": "1.5.0",
  "id": "CVE-2021-29492",
  "aliases": [
    "GHSA-4987-27fx-x6cf"
  ],
  "details": "### Description\r\nEnvoy does not decode escaped slash sequences `%2F` and `%5C` in HTTP URL paths in versions 1.18.2 and before. A remote attacker may craft a path with escaped slashes, e.g. `/something%2F..%2Fadmin`, to bypass access control, e.g. a block on `/admin`. A backend server could then decode slash sequences and normalize path and provide an attacker access beyond the scope provided for by the access control policy.\r\n\r\n### Impact\r\nEscalation of Privileges when using RBAC or JWT filters with enforcement based on URL path. Users with back end servers that interpret `%2F` and `/` and `%5C` and `\\` interchangeably are impacted.\r\n\r\n### Attack Vector\r\nURL paths containing escaped slash characters delivered by untrusted client.\r\n\r\n### Patches\r\nEnvoy versions 1.18.3, 1.17.3, 1.16.4, 1.15.5 contain new path normalization option to decode escaped slash characters.\r\n\r\n### Workarounds\r\nIf back end servers treat `%2F` and `/` and `%5C` and `\\` interchangeably and a URL path based access control is configured, we recommend reconfiguring back end server to not treat `%2F` and `/` and `%5C` and `\\` interchangeably if feasible.\r\n\r\n### Credit\r\nRuilin Yang (ruilin.yrl@gmail.com)\r\n\r\n### References\r\nhttps://blog.envoyproxy.io\r\nhttps://github.com/envoyproxy/envoy/releases\r\n\r\n### For more information\r\nIf you have any questions or comments about this advisory:\r\n* Open an issue in [Envoy repo](https://github.com/envoyproxy/envoy/issues)\r\n* Email us at [envoy-security](mailto:envoy-security@googlegroups.com)\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.15.4"
            },
            {
              "fixed": "1.15.5"
            },
            {
              "introduced": "1.16.3"
            },
            {
              "fixed": "1.16.4"
            },
            {
              "introduced": "1.17.2"
            },
            {
              "fixed": "1.17.3"
            },
            {
              "introduced": "1.18.2"
            },
            {
              "fixed": "1.18.3"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "envoy",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-4987-27fx-x6cf"
    }
  ]
}