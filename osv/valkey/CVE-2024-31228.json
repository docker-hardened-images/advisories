{
  "modified": "2024-11-11T21:16:09Z",
  "published": "2024-11-11T21:16:09Z",
  "schema_version": "1.5.0",
  "id": "CVE-2024-31228",
  "aliases": [
    "GHSA-p4rf-xgfj-c2gq"
  ],
  "details": "### Impact\r\nAuthenticated users can trigger a denial-of-service by using specially crafted, long string match patterns on supported commands such as KEYS, SCAN, PSUBSCRIBE, FUNCTION LIST, COMMAND LIST and ACL definitions. Matching of extremely long patterns may result in unbounded recursion, leading to stack overflow and process crash.\r\n\r\n### Patches\r\nThe problem has been fixed in Valkey 7.2.7 and 8.0.1.\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "valkey",
        "purl": "pkg:dhi/valkey"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "7.2.7"
            },
            {
              "introduced": "8.0.0"
            },
            {
              "fixed": "8.0.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": "valkey-server"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/valkey-io/valkey/security/advisories/GHSA-p4rf-xgfj-c2gq"
    }
  ]
}