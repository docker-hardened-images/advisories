{
  "modified": "2019-12-10T18:35:43Z",
  "published": "2019-12-10T18:35:43Z",
  "schema_version": "1.5.0",
  "id": "CVE-2019-18838",
  "aliases": [
    "GHSA-f2rv-4w6x-rwhc"
  ],
  "details": "# CVE-2019-18838\r\n\r\n## Brief description\r\n\r\nMalformed HTTP request without the Host header may cause abnormal termination of the Envoy process.\r\n\r\n## CVSS\r\n\r\n[CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)\r\n(CVSS score 7.5, High)\r\n\r\n## Affected version(s)\r\n\r\nEnvoy 1.12.1 and before.\r\n\r\n## Affected component(s)\r\n\r\nRoute manager\r\n\r\n## Attack vector(s)\r\n\r\nAn untrusted remote client may send malformed HTTP request, without the \"Host\" header, that may cause an abnormal process termination, when Envoy is configured with encoder filters that access route manager.\r\n\r\n## Discover(s)/Credits\r\n\r\nOleg Guba, Dropbox\r\n\r\n## Details\r\n\r\nUpon receipt of a malformed HTTP request without the \"Host\" header, the Envoy proxy sends the internally generated \"Invalid request\" response. This internally generated response is dispatched through configured encoder filter chain before being sent to the client. An encoder filter that invokes route manager APIs that access request's \"Host\" header, will cause NULL pointer to be dereferenced and result in abnormal termination of the Envoy process.\r\n\r\n## Mitigations\r\n\r\n*   Disable LUA filter.\r\n*   Disable vendor specific encoder filters that access request headers.\r\n\r\n## Detection\r\n\r\nAbnormal termination of the Envoy proxy process with the `Envoy::Router::RouteMatcher::findVirtualHost()` function at the top of the stack trace.\r\n\r\n## References\r\n\r\n* https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18838\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.12.2"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-f2rv-4w6x-rwhc"
    }
  ]
}