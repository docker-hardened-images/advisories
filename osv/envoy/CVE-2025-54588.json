{
  "modified": "2025-09-02T15:17:54Z",
  "published": "2025-09-02T15:17:54Z",
  "schema_version": "1.5.0",
  "id": "CVE-2025-54588",
  "aliases": [
    "GHSA-g9vw-6pvx-7gmw"
  ],
  "details": "### Summary\r\n\r\nA use-after-free (UAF) vulnerability in Envoy's DNS cache causes abnormal process termination. Envoy may reallocate memory when processing a pending DNS resolution, causing list iterator to reference freed memory.\r\n\r\n### Details\r\n\r\nThe vulnerability exists in Envoy's Dynamic Forward Proxy implementation starting from version v1.34.0. The issue occurs when a completion callback for a DNS resolution triggers new DNS resolutions or removes existing pending resolutions. This condition may occur in the following configuration:\r\n\r\n1. Dynamic Forwarding Filter is enabled.\r\n2. `envoy.reloadable_features.dfp_cluster_resolves_hosts` runtime flag is enabled.\r\n3. The Host header is modified between the Dynamic Forwarding Filter and Router filters.\r\n\r\n### Impact\r\n\r\nDenial of service due to abnormal process termination.\r\n\r\n### Attack vector(s)\r\nRequest to Envoy configured as indicated above.\r\n\r\n### Patches\r\nUsers should upgrade to v1.35.1 or v1.34.5. \r\n\r\n### Workaround\r\nSet the `envoy.reloadable_features.dfp_cluster_resolves_hosts` runtime flag to `false`.\r\n\r\n### Detection\r\nAbnormal process termination with the `Envoy::Event::DispatcherImpl::runPostCallbacks()` frame in the call stack.\r\n\r\n### Credits\r\nRohit Agrawal ([agrawroh](https://github.com/agrawroh)) ([rohit.agrawal@databricks.com](mailto:rohit.agrawal@databricks.com))\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "1.34.0-4"
            },
            {
              "fixed": "1.34.5"
            },
            {
              "introduced": "1.35.0"
            },
            {
              "fixed": "1.35.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "go",
        "source_package": "github.com/envoyproxy/envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-g9vw-6pvx-7gmw"
    }
  ]
}