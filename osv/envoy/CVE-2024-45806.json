{
  "modified": "2024-09-19T15:01:58Z",
  "published": "2024-09-19T15:01:58Z",
  "schema_version": "1.5.0",
  "id": "CVE-2024-45806",
  "aliases": [
    "GHSA-ffhv-fvxq-r6mf"
  ],
  "details": "### Summary\r\n\r\nA security vulnerability in Envoy allows external clients to manipulate Envoy headers, potentially leading to unauthorized access or other malicious actions within the mesh.\r\n\r\nThis issue arises due to Envoy's default configuration of internal trust boundaries, which considers all RFC1918 private address ranges as internal.\r\n\r\n### Details\r\n\r\nThe default behavior for handling internal addresses in Envoy has been changed. \r\n\r\nPreviously, RFC1918 IP addresses were automatically considered internal, even if the `internal_address_config` was empty.\r\n\r\nThe default configuration of Envoy will continue to trust internal addresses while in this release but it will not trust them by default in next release.\r\n\r\nIf you have tooling such as probes on your private network which need to be treated as trusted (e.g. changing arbitrary `x-envoy` headers) please explicitly include those addresses or CIDR ranges into `internal_address_config`.\r\n\r\nThe default behavior is controlled by the runtime guard `envoy.reloadable_features.explicit_internal_address_config`, and it is\r\nfalse by default. If you are good to un-trust all IPs, this can be turned on.\r\n\r\n### PoC\r\n\r\n* With a default edge ingress Envoy configured.\r\n* `$  curl -k -H \"X-ENVOY-ORIGINAL-PATH: /foobar\" https://bookinfo-bookinfo.apps.test.cluster.net/productpage`\r\n*  `X-ENVOY-ORIGINAL-PATH` is trusted.\r\n\r\n### Impact:\r\n\r\nSuccessful exploitation could allow attackers to bypass security controls, access sensitive data, or disrupt services within the mesh, like Istio.\r\n\r\n\r\n### Reporter\r\n\r\nJames Force\r\n[jforce@redhat.com](mailto:jforce@redhat.com)\r\n\r\nMike Whale",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.28.7"
            },
            {
              "introduced": "1.29.0"
            },
            {
              "fixed": "1.29.9"
            },
            {
              "introduced": "1.30.0"
            },
            {
              "fixed": "1.30.6"
            },
            {
              "introduced": "1.31.0"
            },
            {
              "fixed": "1.31.2"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": "Envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-ffhv-fvxq-r6mf"
    }
  ]
}