{
  "modified": "2023-10-04T21:59:00Z",
  "published": "2023-10-04T21:59:00Z",
  "schema_version": "1.5.0",
  "id": "CVE-2023-42445",
  "aliases": [
    "GHSA-mrff-q8qj-xvg8"
  ],
  "details": "### Impact\r\n\r\nThis is a XML external entities (XXE) vulnerability. See [CWE-611](https://cwe.mitre.org/data/definitions/611.html) and  [OWASP XXE](https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing).\r\n\r\nIn some cases, when Gradle parses XML files, resolving XML external entities is not disabled. Combined with an Out Of Band XXE attack (OOB-XXE), just parsing XML can lead to exfiltration of local text files to a remote server.\r\n\r\nGradle parses XML files for several purposes. Most of the time, Gradle parses XML files it generated or were already present locally. Only Ivy XML descriptors and Maven POM files can be fetched from remote repositories and parsed by Gradle.\r\n\r\nImpacted use-cases in the Gradle Build Tool:\r\n\r\n| Use case | Vulnerable | Exploitable remotely |\r\n| :--- | :---: | :---: |\r\n| Ivy descriptor parsing | YES | YES |\r\n| Maven POM parsing | NO | NO |\r\n| Maven Toolchains discovery | YES | NO |\r\n| Generation of Ivy and Maven metadata for publishing | YES | NO |\r\n| Dependency Verification metadata | NO | NO |\r\n| EAR deployment descriptor parsing | YES | NO |\r\n| IntelliJ, Eclipse, VisualStudio, xcode file generation | YES | NO |\r\n\r\nIn the use-cases above, only Ivy descriptor parsing is exploitable remotely. This would require an attacker to have control over an Ivy repository used by your build or be able to publish a malicious Ivy descriptor to a repository your build uses for a dependency you use.\r\n\r\nOther use-cases are either not exploitable because existing measures protect from the XXE vulnerability or are only exploitable from local files. An attacker would need to modify your build or local build tool configuration files to exploit the XXE vulnerability.\r\n\r\nNote that the IDE files generation related use cases only refer to using the relative Gradle plugins to generate their configuration. Project import in IntelliJ, Android Studio or Eclipse are not impacted.\r\n\r\n### Patches\r\n\r\nIn Gradle 7.6.3 and 8.4, resolving XML external entities has been disabled for all use cases to protect against this vulnerability. Gradle will now refuse to parse XML files that have XML external entities.\r\n\r\nIt is recommended that users upgrade to a patched version.\r\n\r\n### Workarounds\r\n\r\nIf you are unable to upgrade to Gradle 7.6.3 or 8.4, you can disable resolving XML external entities by setting [JAXP](https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E) system properties.\r\n\r\nThis can be done on the command line by adding the following:\r\n```\r\n-Djavax.xml.accessExternalDTD=false -Djavax.xml.accessExternalSchema=false -Djavax.xml.accessExternalStylesheet=false \r\n```\r\n\r\nThis can be made persistent by adding the following lines in a `gradle.properties` file:\r\n```\r\nsystemProps.javax.xml.accessExternalDTD=false\r\nsystemProps.javax.xml.accessExternalSchema=false\r\nsystemProps.javax.xml.accessExternalStylesheet=false \r\n```\r\n\r\n### References\r\n\r\n* [CWE-611](https://cwe.mitre.org/data/definitions/611.html)\r\n* [OWASP XXE](https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing)\r\n* [JAXP Security Guide](https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E)\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "gradle",
        "purl": "pkg:dhi/gradle"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "7.6.3"
            },
            {
              "introduced": "8.0.0"
            },
            {
              "fixed": "8.4.0"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "java",
        "source_package": "Gradle"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/gradle/gradle/security/advisories/GHSA-mrff-q8qj-xvg8"
    }
  ]
}