{
  "modified": "2021-12-08T15:46:02Z",
  "published": "2021-12-07T17:18:47Z",
  "schema_version": "1.5.0",
  "id": "CVE-2021-43798",
  "aliases": [
    "GHSA-8pjx-jj86-j47p"
  ],
  "details": "Today we are releasing Grafana 8.3.1, 8.2.7, 8.1.8, 8.0.7. This patch release includes a high severity security fix that affects Grafana versions from v8.0.0-beta1 through v8.3.0.\r\n\r\nRelease v8.3.1, only containing a security fix:\r\n\r\n- [Download Grafana 8.3.1](https://grafana.com/grafana/download/8.3.1)\r\n- [Release notes](https://grafana.com/docs/grafana/latest/release-notes/release-notes-8-3-1/)\r\n\r\nRelease v8.2.7, only containing a security fix:\r\n\r\n- [Download Grafana 8.2.7](https://grafana.com/grafana/download/8.2.7)\r\n- [Release notes](https://grafana.com/docs/grafana/latest/release-notes/release-notes-8-2-7/)\r\n\r\nRelease v8.1.8, only containing a security fix:\r\n\r\n- [Download Grafana 8.1.8](https://grafana.com/grafana/download/8.1.8)\r\n- [Release notes](https://grafana.com/docs/grafana/latest/release-notes/release-notes-8-1-8/)\r\n\r\nRelease v8.0.7, only containing a security fix:\r\n\r\n- [Download Grafana 8.0.7](https://grafana.com/grafana/download/8.0.7)\r\n- [Release notes](https://grafana.com/docs/grafana/latest/release-notes/release-notes-8-0-7/)\r\n\r\n\r\n## Path Traversal ([CVE-2021-43798](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43798))\r\n\r\n### Summary \r\n\r\nOn 2021-12-03, we received a report that Grafana is vulnerable to directory traversal, allowing access to local files. We have confirmed this for versions 8.0.0-beta1 to 8.3.0. Thanks to our defense-in-depth approach, at no time has [Grafana Cloud](https://grafana.com/cloud) been vulnerable.\r\n\r\nThe vulnerable URL path is: \u003cgrafana_host_url\u003e/public/plugins/\u003cplugin-id\u003e/, where \u003cplugin-id\u003e is the plugin ID for any installed plugin.\r\n\r\nEvery Grafana instance comes with pre-installed plugins like the Prometheus plugin or MySQL plugin so the following URLs are vulnerable for every instance:\r\n\r\n* \u003cgrafana_host_url\u003e/public/plugins/alertlist/\r\n* \u003cgrafana_host_url\u003e/public/plugins/annolist/\r\n* \u003cgrafana_host_url\u003e/public/plugins/barchart/\r\n* \u003cgrafana_host_url\u003e/public/plugins/bargauge/\r\n* \u003cgrafana_host_url\u003e/public/plugins/candlestick/\r\n* \u003cgrafana_host_url\u003e/public/plugins/cloudwatch/\r\n* \u003cgrafana_host_url\u003e/public/plugins/dashlist/\r\n* \u003cgrafana_host_url\u003e/public/plugins/elasticsearch/\r\n* \u003cgrafana_host_url\u003e/public/plugins/gauge/\r\n* \u003cgrafana_host_url\u003e/public/plugins/geomap/\r\n* \u003cgrafana_host_url\u003e/public/plugins/gettingstarted/\r\n* \u003cgrafana_host_url\u003e/public/plugins/grafana-azure-monitor-datasource/\r\n* \u003cgrafana_host_url\u003e/public/plugins/graph/\r\n* \u003cgrafana_host_url\u003e/public/plugins/heatmap/\r\n* \u003cgrafana_host_url\u003e/public/plugins/histogram/\r\n* \u003cgrafana_host_url\u003e/public/plugins/influxdb/\r\n* \u003cgrafana_host_url\u003e/public/plugins/jaeger/\r\n* \u003cgrafana_host_url\u003e/public/plugins/logs/\r\n* \u003cgrafana_host_url\u003e/public/plugins/loki/\r\n* \u003cgrafana_host_url\u003e/public/plugins/mssql/\r\n* \u003cgrafana_host_url\u003e/public/plugins/mysql/\r\n* \u003cgrafana_host_url\u003e/public/plugins/news/\r\n* \u003cgrafana_host_url\u003e/public/plugins/nodeGraph/\r\n* \u003cgrafana_host_url\u003e/public/plugins/opentsdb\r\n* \u003cgrafana_host_url\u003e/public/plugins/piechart/\r\n* \u003cgrafana_host_url\u003e/public/plugins/pluginlist/\r\n* \u003cgrafana_host_url\u003e/public/plugins/postgres/\r\n* \u003cgrafana_host_url\u003e/public/plugins/prometheus/\r\n* \u003cgrafana_host_url\u003e/public/plugins/stackdriver/\r\n* \u003cgrafana_host_url\u003e/public/plugins/stat/\r\n* \u003cgrafana_host_url\u003e/public/plugins/state-timeline/\r\n* \u003cgrafana_host_url\u003e/public/plugins/status-history/\r\n* \u003cgrafana_host_url\u003e/public/plugins/table/\r\n* \u003cgrafana_host_url\u003e/public/plugins/table-old/\r\n* \u003cgrafana_host_url\u003e/public/plugins/tempo/\r\n* \u003cgrafana_host_url\u003e/public/plugins/testdata/\r\n* \u003cgrafana_host_url\u003e/public/plugins/text/\r\n* \u003cgrafana_host_url\u003e/public/plugins/timeseries/\r\n* \u003cgrafana_host_url\u003e/public/plugins/welcome/\r\n* \u003cgrafana_host_url\u003e/public/plugins/zipkin/\r\n\r\nWe have received CVE-2021-43798 for this issue. The CVSS score for this vulnerability is 7.5 High (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N) for Grafana versions 8.0.0-beta1 to 8.3.0 \r\n\r\n### Affected versions with high severity \r\n\r\nGrafana 8.0.0-beta1 to 8.3.0\r\n\r\n### Solutions and mitigations\r\n\r\nAll installations between v8.0.0-beta1 and v8.3.0 should be upgraded as soon as possible.\r\n\r\nIf you can not upgrade, running a reverse proxy in front of Grafana that normalizes the PATH of the request will mitigate the vulnerability. For example the normalize_path setting in envoy.\r\n\r\nThanks to our defense-in-depth approach, [Grafana Cloud](https://grafana.com/cloud) instances have not been affected by the vulnerability.\r\n\r\nAs always, we closely coordinated with all cloud providers licensed to offer Grafana Pro. They have received early notification under embargo and confirmed that their offerings are secure at the time of this announcement. In alphabetical order, this is applicable to Amazon Managed Grafana, and Azure Managed Grafana.\r\n\r\n### Timeline and postmortem\r\n\r\nHere is a detailed timeline starting from when we originally learned of the issue. All times in UTC.\r\n\r\n* 2021-12-03: Security researcher sends the initial report\r\n* 2021-12-03: Confirmed for 8.0.0-beta1 through 8.3.0\r\n* 2021-12-03: Confirmed that Grafana Cloud is not vulnerable\r\n* 2021-12-03: Security fix determined and committed to Git\r\n* 2021-12-03: Release timeline determined: 2021-12-07 for private customer release, 2021-12-14 for public release\r\n* 2021-12-06: Second report about the vulnerability received\r\n* 2021-12-07: We received information that the vulnerability has been leaked to the public, turning it into a 0 day\r\n* 2021-12-07: Decision made to release as quickly as feasible\r\n* 2021-12-07: Private release with reduced two hour grace period instead of the usual 1 week\r\n* 2021-12-07: Public release\r\n\r\n### Acknowledgements\r\n\r\nWe would like to thank [Jordy Versmissen](https://twitter.com/j0v0x0) for finding the vulnerability and alerting us to it.\r\n\r\n## Reporting security Issues\r\n\r\nIf you think you have found a security vulnerability, please send a report to [security@grafana.com](mailto:security@grafana.com). This address can be used for all of\r\nGrafana Labs' open source and commercial products (including but not limited to Grafana, Grafana Cloud, Grafana Enterprise, and grafana.com). We can accept only vulnerability reports at this address. We would prefer that you encrypt your message to us by using our PGP key. The key fingerprint is\r\n\r\nF988 7BEA 027A 049F AE8E  5CAA D125 8932 BE24 C5CA\r\n\r\nThe key is available from [keyserver.ubuntu.com](https://keyserver.ubuntu.com/pks/lookup?search=0xF9887BEA027A049FAE8E5CAAD1258932BE24C5CA\u0026fingerprint=on\u0026op=index).\r\n\r\n## Security announcements\r\n\r\nWe maintain a [security category on our blog](https://grafana.com/tags/security/), where we will always post a summary, remediation, and mitigation details for any patch containing security fixes. \r\n\r\nYou can also subscribe to our [RSS feed](https://grafana.com/tags/security/index.xml).\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "grafana",
        "purl": "pkg:dhi/grafana"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "8.0.0"
            },
            {
              "fixed": "8.0.7"
            },
            {
              "introduced": "8.1.0"
            },
            {
              "fixed": "8.1.8"
            },
            {
              "introduced": "8.2.0"
            },
            {
              "fixed": "8.2.7"
            },
            {
              "introduced": "8.3.0"
            },
            {
              "fixed": "8.3.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "grafana",
        "source_package": "Path parser \u0026 escaping"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/grafana/grafana/security/advisories/GHSA-8pjx-jj86-j47p"
    }
  ]
}