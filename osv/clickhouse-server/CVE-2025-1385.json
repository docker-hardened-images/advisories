{
  "modified": "2025-03-20T07:16:45Z",
  "published": "2025-03-20T07:16:45Z",
  "schema_version": "1.5.0",
  "id": "CVE-2025-1385",
  "aliases": [
    "GHSA-5phv-x8x4-83x5"
  ],
  "details": "### Impact\r\n\r\nWhen the library bridge feature is enabled, the clickhouse-library-bridge exposes an HTTP API on localhost. This allows clickhouse-server to dynamically load a library from a specified path and execute it in an isolated process. Combined with the ClickHouse table engine functionality that permits file uploads to specific directories, a misconfigured server can be exploited by an attacker with privilege to access to both table engines to execute arbitrary code on the ClickHouse server.\r\n\r\nYou can check if your ClickHouse server is vulnerable to this vulnerability by inspecting the configuration file and confirming if the following setting is enabled:\r\n\r\n```\r\n\u003clibrary_bridge\u003e\r\n   \u003cport\u003e9019\u003c/port\u003e\r\n\u003c/library_bridge\u003e\r\n```\r\n### Patch\r\n\r\nFor OSS users, the fix has been backported to all supported versions listed in security.md. Please ensure your ClickHouse instances are running at least one of the following minimum versions:\r\n\r\n24.3.18.6, 24.8.14.27, 24.11.5.34, 24.12.5.65, 25.1.5.5\r\n\r\n**ClickHouse Cloud is not vulnerable to this vulnerability.**\r\n\r\nIf you are maintaining your own forked version of ClickHouse, the fix for this vulnerability can be found in [#75954](https://github.com/ClickHouse/ClickHouse/pull/75954).\r\n\r\nWorkaround\r\nIf upgrading ClickHouse is not an option, you can disable the library bridge by commenting out the bridge configuration option.\r\n\r\nCredit: This vulnerability was reported by Arseniy Dugin.",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "clickhouse-server",
        "purl": "pkg:dhi/clickhouse-server"
      },
      "database_specific": {
        "range_status": "error parsing vulnerable versions: error sanitizing version: invalid version: 24.3.18.6",
        "source_ecosystem": "",
        "source_package": "ClickHouse"
      }
    },
    {
      "package": {
        "ecosystem": "DHI",
        "name": "clickhouse-server",
        "purl": "pkg:dhi/clickhouse-server"
      },
      "database_specific": {
        "range_status": "error parsing vulnerable versions: error sanitizing version: invalid version: 24.8.14.27",
        "source_ecosystem": "",
        "source_package": "ClickHouse"
      }
    },
    {
      "package": {
        "ecosystem": "DHI",
        "name": "clickhouse-server",
        "purl": "pkg:dhi/clickhouse-server"
      },
      "database_specific": {
        "range_status": "error parsing vulnerable versions: error sanitizing version: invalid version: 24.11.5.34",
        "source_ecosystem": "",
        "source_package": "ClickHouse"
      }
    },
    {
      "package": {
        "ecosystem": "DHI",
        "name": "clickhouse-server",
        "purl": "pkg:dhi/clickhouse-server"
      },
      "database_specific": {
        "range_status": "error parsing vulnerable versions: error sanitizing version: invalid version: 24.12.5.65",
        "source_ecosystem": "",
        "source_package": "ClickHouse"
      }
    },
    {
      "package": {
        "ecosystem": "DHI",
        "name": "clickhouse-server",
        "purl": "pkg:dhi/clickhouse-server"
      },
      "database_specific": {
        "range_status": "error parsing vulnerable versions: error sanitizing version: invalid version: 25.1.5.5",
        "source_ecosystem": "",
        "source_package": "ClickHouse"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/ClickHouse/ClickHouse/security/advisories/GHSA-5phv-x8x4-83x5"
    }
  ]
}