{
  "modified": "2023-01-26T08:58:00Z",
  "published": "2023-01-26T08:58:00Z",
  "schema_version": "1.5.0",
  "id": "CVE-2022-41912",
  "aliases": [
    "GHSA-5hcf-rqj9-xh96"
  ],
  "details": "### Summary\r\n\r\nGrafana Enterprise is using [crewjam/saml](https://github.com/crewjam/saml) library for SAML integration. On Nov 30, 2022 an [advisory](https://github.com/advisories/GHSA-j2jp-wvqg-wc2g) and relevant fix was published in the upstream library, which described a vulnerability allowing privilege escalation when processing SAML responses containing multiple assertions. \r\n\r\nThe vulnerability is possible to exploit only when a SAML document is not signed and multiple assertions are being used, where at least one assertion is signed. As a result, an attacker could intercept the SAML response and add any unsigned assertion, which would be parsed as signed by the library.\r\n\r\n### Steps to reproduce\r\n\r\nLog in with SAML with any credentials\r\nIntercept the SAML response which contains one signed assertion\r\nAdd any new unsigned identity assertion containing Admin username/email\r\nForward the request to Grafana\r\n\r\n### Mitigations\r\n\r\nTo fully address CVE-2022-41912 please upgrade your Grafana instances. As an alternative, you could ensure to sign the entire SAML document, or stop using SAML temporarily.",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "grafana",
        "purl": "pkg:dhi/grafana"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "6.3.0-beta1"
            },
            {
              "fixed": "8.5.16"
            },
            {
              "introduced": "9.0.0"
            },
            {
              "fixed": "9.2.8"
            },
            {
              "introduced": "9.3.0"
            },
            {
              "fixed": "9.3.2"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/grafana/grafana/security/advisories/GHSA-5hcf-rqj9-xh96"
    }
  ]
}