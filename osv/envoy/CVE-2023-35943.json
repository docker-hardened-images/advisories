{
  "modified": "2023-07-25T15:11:57Z",
  "published": "2023-07-25T15:11:57Z",
  "schema_version": "1.5.0",
  "id": "CVE-2023-35943",
  "aliases": [
    "GHSA-mc6h-6j9x-v3gq"
  ],
  "details": "### Summary\r\n\r\nCORS filter will segfault and crash Envoy when the `origin` header is removed and deleted between `decodeHeaders`and `encodeHeaders`.\r\n\r\n### Affected components\r\nHTTP CORS filter\r\n\r\n### Details\r\nIn the CORS filter's `decodeHeaders` method, a pointer to the `origin` header is captured. If the `origin` header is configured to be removed, a segfault crash will occur when the pointer is used again in `encodeHeaders` since it has been dereferenced.\r\n\r\n### PoC\r\n* User configuration: `origin` header is configured to be removed with `request_headers_to_remove: origin`, \r\nhttps://www.envoyproxy.io/docs/envoy/latest/api-v3/config/route/v3/route.proto\r\n* `decodeHeaders` stores the pointer of `origin`, and then the header is removed.\r\n* A segfault crash will occur in `encodeHeader` in CORS filter.\r\n\r\n### Impact\r\nThere will be a segfault crash in the CORS filter\r\n\r\n### Mitigation\r\nNot removing the `origin` header in Envoy configuration\r\n\r\n### Detection\r\nCrashes in CORS filter.\r\n\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.23.12"
            },
            {
              "introduced": "1.24.0"
            },
            {
              "fixed": "1.24.10"
            },
            {
              "introduced": "1.25.0"
            },
            {
              "fixed": "1.25.9"
            },
            {
              "introduced": "1.26.0"
            },
            {
              "fixed": "1.26.4"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "",
        "source_package": "Envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-mc6h-6j9x-v3gq"
    }
  ]
}