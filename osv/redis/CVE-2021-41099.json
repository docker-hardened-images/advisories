{
  "modified": "2021-10-04T11:33:07Z",
  "published": "2021-10-04T11:33:07Z",
  "schema_version": "1.5.0",
  "id": "CVE-2021-41099",
  "aliases": [
    "GHSA-j3cr-9h5g-6cph"
  ],
  "details": "### Impact\r\nAn integer overflow bug in the underlying string library can be used to corrupt the heap and potentially result with denial of service or remote code execution.\r\n\r\nThe vulnerability involves changing the default `proto-max-bulk-len` configuration parameter to a very large value and constructing specially crafted network payloads or commands.\r\n\r\n### Patches\r\nThe problem is fixed in Redis versions 6.2.6, 6.0.16 and 5.0.14.\r\n\r\n### Workarounds\r\nAn additional workaround to mitigate the problem without patching the `redis-server` executable is to prevent users from modifying the `proto-max-bulk-len` configuration parameter. This can be done using ACL to restrict unprivileged users from using the CONFIG SET command.\r\n\r\n### Credit\r\nThis issue was discovered and reported by yiyuaner.\r\n\r\n### For more information\r\nIf you have any questions or comments about this advisory:\r\n* Open an issue in [the Redis repository](https://github.com/redis/redis)\r\n* Email us at redis@redis.io\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "redis",
        "purl": "pkg:dhi/redis"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.0.14"
            },
            {
              "introduced": "6.0.0"
            },
            {
              "fixed": "6.0.16"
            },
            {
              "introduced": "6.2.0"
            },
            {
              "fixed": "6.2.6"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "redis",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/redis/redis/security/advisories/GHSA-j3cr-9h5g-6cph"
    }
  ]
}