{
  "modified": "2020-09-29T21:39:26Z",
  "published": "2020-09-29T21:39:26Z",
  "schema_version": "1.5.0",
  "id": "CVE-2020-25018",
  "aliases": [
    "GHSA-fwwh-fc9w-9673"
  ],
  "details": "## Brief description\r\n\r\nEnvoy master between 2d69e30 and 3b5acb2 may fail to parse request URL that requires host canonicalization.\r\n\r\n## CVSS\r\n\r\n[CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H) (7.5, High)\r\n\r\n## Affected version(s)\r\n\r\nEnvoy master between 2d69e30 and 3b5acb2\r\n\r\n## Affected component(s)\r\n\r\nURL parser\r\n\r\n## Attack vector(s)\r\n\r\nUse of Internationalized Domain Name (IDN), that requires canonicalization (Punycode encoding: to convert Unicode characters to ASCII), as the host component in the request URL.\r\n\r\n## Discover(s)/Credits\r\n\r\nAsra Ali (Google LLC), Dhi Aurrahman (Tetrate.io)\r\n\r\n## Details\r\n\r\nEnvoy master between 2d69e30 and 3b5acb2 may fail to parse request URL that requires host canonicalization. The use of Internationalized Domain Name (IDN) as the host component in a request URL triggers the URL parser library used by Envoy to do Punycode encoding (to convert Unicode characters to ASCII). Since the conversion data is not available, it fails the conversion, which could result in executing code in faulting address (segmentation fault).\r\n\r\n## Detection\r\n\r\nAbnormal termination of the Envoy proxy process with the `url::IDNToASCII()` function at the top of the stack trace.\r\n\r\n## References\r\n\r\n* CVE: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25018",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "database_specific": {
        "range_status": "error parsing vulnerable versions: error sanitizing version: invalid version: envoypro0y/envoy.0",
        "source_ecosystem": "",
        "source_package": "Envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-fwwh-fc9w-9673"
    }
  ]
}