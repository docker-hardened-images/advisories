{
  "modified": "2025-05-08T14:22:21Z",
  "published": "2025-05-07T20:24:31Z",
  "schema_version": "1.5.0",
  "id": "CVE-2025-46821",
  "aliases": [
    "GHSA-c7cm-838g-6g67"
  ],
  "details": "### Summary\r\nEnvoy's URI template matcher does not match URI paths containing the `*` character.\r\n\r\n### Affected Components\r\nEnvoy's [URI template matcher](https://www.envoyproxy.io/docs/envoy/v1.34.0/api-v3/extensions/path/match/uri_template/v3/uri_template_match.proto.html) and Envoy's [HTTP RBAC extension](https://www.envoyproxy.io/docs/envoy/v1.34.0/api-v3/config/rbac/v3/rbac.proto) when configured with the `uri_template` permissions.\r\n\r\n### Details\r\nEnvoy's URI template matcher incorrectly excludes the `*` character from a set of valid characters in the URI path. As a result URI path containing the `*` character will not match a URI template expressions.\r\n\r\n### Impact\r\nBypass of RBAC rules when configured using the `uri_template` permissions.\r\n\r\n### Attack vector(s)\r\nA request from an untrusted peer with URI path containing the `*` character.\r\n\r\n### Patches\r\nThis vulnerability is fixed in Envoy versions v1.34.1, v1.33.3, v1.32.6, v1.31.8\r\n\r\n### Workarounds\r\nConfigure additional RBAC permissions using `url_path` with `safe_regex` expression.\r\n\r\n### Detection\r\nAccess log entries to excluded endpoints with the `*` character(s) in request URI path.\r\n\r\n## Credits\r\nDiscovery: \"Chwila, Bartosz\" \u003cbartosz.chwila@sap.com\u003e\r\nDiagnostics: Jackie Maertens (Elliott): https://github.com/jaellio\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.31.8"
            },
            {
              "introduced": "1.32.0"
            },
            {
              "fixed": "1.32.6"
            },
            {
              "introduced": "1.33.0"
            },
            {
              "fixed": "1.33.3"
            },
            {
              "introduced": "1.34.0"
            },
            {
              "fixed": "1.34.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "envoy proxy",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-c7cm-838g-6g67"
    }
  ]
}