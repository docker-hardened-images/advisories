{
  "modified": "2025-06-26T16:49:31Z",
  "published": "2025-06-18T06:03:48Z",
  "schema_version": "1.5.0",
  "id": "CVE-2025-50200",
  "aliases": [
    "GHSA-gh3x-4x42-fvq8"
  ],
  "details": "### Summary\r\n\r\nRabbitMQ seems to be logging authorization header in plaintext (encoded in base64) when error arises, e.g. non-existent queue\r\n\r\n### Details\r\n\r\nWhen querying RabbitMQ api with HTTP/s with basic authentication it creates logs with all headers in request, including authorization headers - Showing base64 encoded username:password - which is easy to decode and afterwards used to obtain control to the system (depending on the type of credentials).\r\n\r\n#### Found on\r\n\r\n- OS: Windows\r\n- RabbitMQ 3.13.7 and 3.13.2\r\n- Erlang 26.2.5\r\n\r\n\r\n### PoC\r\n\r\n- Created new admin user \"tmp\" with pwd \"tmp\" via rabbitmq management console:\r\n\r\n![image](https://github.com/user-attachments/assets/ad7faa03-14d8-4b37-b182-7df2e6ff01e0)\r\n\r\n- Created a GET request in pwsh using basic authentication to non-existent queue\r\n\r\n- Executed pwsh script [PoCRabbitMQ.txt](https://github.com/user-attachments/files/19337371/PoCRabbitMQ.txt)\r\n\r\n```\r\n$Username = \"tmp\"\r\n$Password = \"tmp\"\r\n\r\n$QueueName = \"RANDOM\"\r\n$Url = \"http://localhost:15672/api/queues/%2F/$QueueName/get\"\r\n\r\n# Encode credentials\r\n$EncodedCredentials = [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes(\"$Username`:$Password\"))\r\n$Headers = @{\r\n    \"Authorization\" = \"Basic $EncodedCredentials\"\r\n    \"Content-Type\" = \"application/json\"\r\n}\r\n\r\n# Request body\r\n$Body = @{\r\n    \"count\" = 10\r\n    \"requeue\" = $false\r\n    \"encoding\" = \"auto\"\r\n} | ConvertTo-Json -Compress\r\n\r\n# Send request\r\n$Response = Invoke-WebRequest -Uri $Url -Method Post -Headers $Headers -Body $Body\r\n\r\n# Print messages\r\n$Messages = $Response.Content | ConvertFrom-Json\r\n$Messages | ForEach-Object { Write-Output \"Message: $($_.payload)\" }\r\n```\r\n\r\n- Checked the logs of RabbitMQ and found the error logs with the authorization headers:\r\n\r\n```\r\n[error] .... \r\nheaders =\u003e\r\n    #{\u003c\u003c\"authorization\"\u003e\u003e =\u003e\r\n    \u003c\u003c\"Basic ......\r\n```\r\n\r\n\r\n### Impact\r\nInformation Disclosure of credentials of users whose actions may raise an error - like searching queue that does not exist.\r\n\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "rabbitmq",
        "purl": "pkg:dhi/rabbitmq"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "4.0.8"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/rabbitmq/rabbitmq-server/security/advisories/GHSA-gh3x-4x42-fvq8"
    }
  ]
}