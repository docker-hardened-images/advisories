{
  "modified": "2022-02-10T08:44:55Z",
  "published": "2022-02-10T08:44:55Z",
  "schema_version": "1.5.0",
  "id": "CVE-2022-23630",
  "aliases": [
    "GHSA-9pf5-88jw-3qgr"
  ],
  "details": "### Impact\r\n\r\nDependency verification is a security feature in Gradle Build Tool that was introduced to allow validation of external dependencies either through their checksum or cryptographic signatures.\r\n\r\nIn some cases, Gradle may skip that verification and accept a dependency that would otherwise fail the build as an untrusted external artifact.\r\n\r\nThis occurs when dependency verification is disabled on one or more configurations _and_ those configurations have common dependencies with other configurations that have dependency verification enabled. If the configuration that has dependency verification disabled is resolved _first_, Gradle does not verify the common dependencies for the configuration that has dependency verification enabled.\r\n\r\nFor builds that are vulnerable, there are two risks:\r\n* Dependency poisoning/Dependency confusion: Gradle could download a malicious binary from a repository outside your organization due to name squatting.\r\n* Man In The Middle: If you are still using HTTP only and not HTTPS for downloading dependencies, your build could download a malicious library instead of the expected one.\r\n\r\n### Patches\r\nGradle 7.4 fixes that issue by validating artifacts at least once if they are present in a resolved configuration that has dependency verification active.\r\n\r\n### Workarounds\r\n* Do not use `ResolutionStrategy.disableDependencyVerification()` and do not use plugins that use that method to disable dependency verification for a single configuration.\r\n* Make sure resolution of configuration that disable that feature do not happen in builds that resolve configuration where the feature is enabled.\r\n\r\n### References\r\n- [CWE-829: Inclusion of Functionality from Untrusted Control Sphere](https://cwe.mitre.org/data/definitions/829.html)\r\n- [A Confusing Dependency](https://blog.autsoft.hu/a-confusing-dependency/)\r\n- [Dependency Confusion](https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610)\r\n\r\n### Questions?\r\n* For security related issues, please email us at security@gradle.com.\r\n* For non-security related issues, please open an issue on [GitHub](https://github.com/gradle/gradle/issues/new/choose).\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "gradle",
        "purl": "pkg:dhi/gradle"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "6.2.0"
            },
            {
              "fixed": "7.4.0"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "java",
        "source_package": "Gradle"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/gradle/gradle/security/advisories/GHSA-9pf5-88jw-3qgr"
    }
  ]
}