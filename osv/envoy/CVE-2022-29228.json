{
  "modified": "2022-06-09T16:12:56Z",
  "published": "2022-06-09T16:12:56Z",
  "schema_version": "1.5.0",
  "id": "CVE-2022-29228",
  "aliases": [
    "GHSA-rww6-8h7g-8jf6"
  ],
  "details": "# Attack type\r\nRemote\r\n\r\n# Impact\r\nDenial of Service (crash)\r\n\r\n# Affected component(s)\r\nOAuth.\r\n\r\n# Attack vector(s)\r\nRemote.\r\n\r\n# Discoverer(s)/Credits\r\nIdentified by Raul Gutierrez Segales \u003crgs@pinterest.com\u003e while investigating  https://github.com/envoyproxy/envoy/security/advisories/GHSA-h45c-2f94-prxh, originally reported by Weiqiu Wen [ff800u@gmail.com](mailto:ff800u@gmail.com)\r\n\r\n# References\r\nSee also https://github.com/envoyproxy/envoy/security/advisories/GHSA-h45c-2f94-prxh\r\n\r\n# Description (brief; included in CVE)\r\nThe OAuth filter would try to invoke the remaining filters in the chain after emitting a local response, which triggers an ASSERT() in newer versions and corrupts memory on earlier versions.\r\n\r\n# Example exploit or proof-of-concept\r\nThe general authentication flow in the oauth filter triggers this condition, so should be exploitable. \r\n\r\n# Description (full; not included in CVE but will be published on GitHub later and linked)\r\ncontinueDecoding() shouldnâ€™t ever be called from filters after a local reply has been sent.\r\n\r\n# Mitigation\r\nNA.\r\n\r\n# Detection\r\nCrashes with possible unrelated stack traces after successful oauth flow metrics are emitted.\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.22.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "envoy",
        "source_package": "Envoy"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-rww6-8h7g-8jf6"
    }
  ]
}