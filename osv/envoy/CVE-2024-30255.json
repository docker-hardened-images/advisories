{
  "modified": "2024-04-09T15:04:17Z",
  "published": "2024-04-04T09:51:17Z",
  "schema_version": "1.5.0",
  "id": "CVE-2024-30255",
  "aliases": [
    "GHSA-j654-3ccm-vfmm"
  ],
  "details": "### Summary\r\nHTTP/2 protocol stack in Envoy versions 1.29.2 or earlier are vulnerable to CPU exhaustion due to flood of CONTINUATION frames.\r\n\r\n### Affected Components\r\nHTTP/2 protocol stack.\r\n\r\n### Details\r\nEnvoy's HTTP/2 codec allows the peer to send an unlimited number of CONTINUATION frames even after exceeding Envoy's header map limits. This allows an attacker to send a sequence of CONTINUATION frames without the END_HEADERS bit set causing CPU utilization, consuming approximately 1 core per 300Mbit/s of traffic.\r\n\r\n### Impact\r\nDenial of service through CPU exhaustion.\r\n\r\n### Attack vector(s)\r\nSequence of CONTINUATION frames without the END_HEADERS bit set, from an untrusted HTTP/2 peer.\r\n\r\n### Patches\r\nUsers should upgrade to versions 1.29.3 to mitigate the effects of the CONTINUATION flood. \r\nNote that Envoy versions 1.29.0 and 1.29.1 are additionally impacted by [CVE-2024-27919](https://github.com/envoyproxy/envoy/security/advisories/GHSA-gghf-vfxp-799r)\r\n\r\n### Workarounds\r\nDisable HTTP/2 protocol.\r\n\r\n### Detection\r\nHigh CPU utilization without corresponding increase in request load with CPU profiles showing elevated CPU utilization in HTTP/2 codec.\r\n\r\n### Credits\r\nBartek Nowotarski  https://nowotarski.info/\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "envoy",
        "purl": "pkg:dhi/envoy"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.26.8"
            },
            {
              "introduced": "1.27.0"
            },
            {
              "fixed": "1.27.4"
            },
            {
              "introduced": "1.28.0"
            },
            {
              "fixed": "1.28.2"
            },
            {
              "introduced": "1.29.0"
            },
            {
              "fixed": "1.29.3"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "envoy proxy",
        "source_package": ""
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-j654-3ccm-vfmm"
    }
  ]
}