{
  "modified": "2023-07-10T12:39:45Z",
  "published": "2023-07-10T12:39:45Z",
  "schema_version": "1.5.0",
  "id": "CVE-2022-24834",
  "aliases": [
    "GHSA-p8x2-9v9q-c838"
  ],
  "details": "### Impact\r\nA specially crafted Lua script executing in Redis can trigger a heap overflow in the cjson and cmsgpack libraries, and result in heap corruption and potentially remote code execution.\r\n\r\nThe problem exists in all versions of Redis with Lua scripting support, starting from 2.6, and affects only authenticated and authorized users.\r\n\r\n### Patches\r\nThe problem is fixed in versions 7.0.12, 6.2.13, 6.0.20.\r\n\r\n### Workarounds\r\nAn additional workaround to mitigate the problem without patching the redis-server executable is to prevent users from executing Lua scripts. This can be done using ACL to restrict EVAL and EVALSHA commands.\r\n\r\n### Credit\r\nThe problem was reported by Seiya Nakata and Yudai Fujiwara, security researchers from Ricerca Security, Inc.\r\n\r\n### For more information\r\nIf you have any questions or comments about this advisory:\r\n* Open an issue in [the Redis repository](https://github.com/redis/redis)\r\n* Email us at redis@redis.io",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "redis",
        "purl": "pkg:dhi/redis"
      },
      "database_specific": {
        "range_status": "error parsing vulnerable versions: error sanitizing version: invalid version: All.0",
        "source_ecosystem": "n/a",
        "source_package": "redis-server"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/redis/redis/security/advisories/GHSA-p8x2-9v9q-c838"
    }
  ]
}