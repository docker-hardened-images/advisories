{
  "modified": "2022-04-27T18:09:54Z",
  "published": "2022-04-27T18:09:54Z",
  "schema_version": "1.5.0",
  "id": "CVE-2022-24735",
  "aliases": [
    "GHSA-647m-2wmq-qmvq"
  ],
  "details": "### Impact\r\nBy exploiting weaknesses in the Lua script execution environment, an attacker with access to Redis can inject Lua code that will execute with the (potentially higher) privileges of another Redis user.\r\n\r\nThe Lua script execution environment in Redis provides some measures that prevent a script from creating side effects that persist and can affect the execution of the same, or different script, at a later time. Several weaknesses of these measures have been publicly known for a long time, but they had no security impact as the Redis security model did not endorse the concept of users or privileges.\r\n\r\nWith the introduction of ACLs in Redis 6.0, these weaknesses can be exploited by a less privileged users to inject Lua code that will execute at a later time, when a privileged user executes a Lua script.\r\n\r\n### Patches\r\nThe problem is fixed in Redis versions 7.0.0 and 6.2.7.\r\n\r\n### Workarounds\r\nAn additional workaround to mitigate this problem without patching the redis-server executable, if Lua scripting is not being used, is to block access to `SCRIPT LOAD` and `EVAL` commands using ACL rules.\r\n\r\n### Credit\r\nThis problem has been reported by Aviv Yahav.\r\n\r\n### For more information\r\nIf you have any questions or comments about this advisory:\r\n* Open an issue in [the Redis repository](https://github.com/redis/redis)\r\n* Email us at redis@redis.io",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "redis",
        "purl": "pkg:dhi/redis"
      },
      "database_specific": {
        "range_status": "error parsing vulnerable versions: error sanitizing version: invalid version: All.0",
        "source_ecosystem": "n/a",
        "source_package": "redis"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/redis/redis/security/advisories/GHSA-647m-2wmq-qmvq"
    }
  ]
}