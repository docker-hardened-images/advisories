{
  "modified": "2023-12-19T04:06:12Z",
  "published": "2023-12-18T19:02:25Z",
  "schema_version": "1.5.0",
  "id": "CVE-2023-47118",
  "aliases": [
    "GHSA-g22g-p6q2-x39v"
  ],
  "details": "### Impact\r\n\r\nA heap buffer overflow issue was discovered in ClickHouse server. An attacker could send a specially crafted payload to the native interface exposed by default on port 9000/tcp, triggering a bug in the decompression logic of T64 codec that crashes the ClickHouse server process. This attack does not require authentication.\r\n\r\nNote that this exploit can also be triggered via HTTP protocol, however, the attacker will need a valid credential as the HTTP authentication take places first.\r\n\r\n### Patches\r\nFix has been pushed to version v23.10.2.13-stable, v23.9.4.11-stable, v23.8.6.16-lts, v23.3.16.7-lts\r\n\r\n### Workarounds\r\n\r\nAffected users are advised to block native port access and temporary switch to HTTP protocol to reduce the exposure before they can upgrade to supported versions.\r\n\r\n### Backport\r\n\r\nIf you are maintaining your own forked version of ClickHouse. The fix for this vulnerability can be found in [this pull request](https://github.com/ClickHouse/ClickHouse/pull/56434).",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "clickhouse-server",
        "purl": "pkg:dhi/clickhouse-server"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "23.10.2+13"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "clickhouse v23.10",
        "source_package": "ClickHouse v23.10"
      }
    },
    {
      "package": {
        "ecosystem": "DHI",
        "name": "clickhouse-server",
        "purl": "pkg:dhi/clickhouse-server"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "23.8.6+16"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "clickhouse v23.9",
        "source_package": "ClickHouse v23.9"
      }
    },
    {
      "package": {
        "ecosystem": "DHI",
        "name": "clickhouse-server",
        "purl": "pkg:dhi/clickhouse-server"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "23.9.4+11"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "clickhouse v23.8",
        "source_package": "ClickHouse v23.8"
      }
    },
    {
      "package": {
        "ecosystem": "DHI",
        "name": "clickhouse-server",
        "purl": "pkg:dhi/clickhouse-server"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "23.3.16+7"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "clickhouse v23.3",
        "source_package": "ClickHouse v23.3"
      }
    },
    {
      "package": {
        "ecosystem": "DHI",
        "name": "clickhouse-server",
        "purl": "pkg:dhi/clickhouse-server"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "23.9.2+47475"
            }
          ]
        }
      ],
      "database_specific": {
        "source_ecosystem": "clickhouse cloud",
        "source_package": "ClickHouse Cloud"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/ClickHouse/ClickHouse/security/advisories/GHSA-g22g-p6q2-x39v"
    }
  ]
}