{
  "modified": "2025-07-30T10:57:34Z",
  "published": "2022-04-12T11:11:34Z",
  "schema_version": "1.5.0",
  "id": "CVE-2022-24812",
  "aliases": [
    "GHSA-82gq-xfg3-5j7v"
  ],
  "details": "Today we are releasing Grafana Enterprise 8.3.6. This patch release includes HIGH severity security fix for Grafana Enterprise fine-grained access control API Key privilege escalation.\r\n\r\nRelease v.8.4.6, only containing security fixes:\r\n\r\n- [Download Grafana Enterprise 8.4.6](https://grafana.com/grafana/download/8.4.6)\r\n- [Release notes](https://grafana.com/docs/grafana/latest/release-notes/release-notes-8-4-6/)\r\n\r\n## Privilige Escalation\r\n\r\nOn 3rd of April, during an internal security audit, we discovered a security vulnerability which impacts Grafana Enterprise instances which have fine-grained access control beta feature enabled.\r\n\r\nWe believe that this vulnerability is rated at CVSS 8.0 (CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H).\r\n\r\n### Pre-conditions\r\n\r\n- Running Grafana Enterprise 8.1.0-beta1 - 8.4.5\r\n- Fine-grained access control is enabled\r\n- There are at least 2 API Keys with different roles (e.g. one with Admin, one with Editor).\r\n\r\n### Summary\r\n\r\nWhen fine-grained access control is enabled and a client uses Grafana API Key to make requests, the permissions for that API Key are cached for 30 seconds for the given organization. Because of the way the cache ID is constructed, the consequent requests with any API Key evaluate to the same permissions as the previous requests. This can lead to an escalation of privileges, when for example a first request is made with Admin permissions, and the second request with different API Key is made with Viewer permissions, the second request will get the cached permissions from the previous Admin, essentially accessing higher privilege than it should.\r\n\r\n### Impact\r\n\r\nThe vulnerability is only impacting Grafana Enterprise when the fine-grained access control beta feature is enabled and there are more than one API Keys in one organization with different roles assigned.\r\n\r\n### Affected versions with HIGH severity\r\n\r\nAll Grafana Enterprise instances with 8.1.0-beta1 - 8.4.5 versions are affected by this vulnerability.\r\n\r\n### Solutions and mitigations\r\n\r\nAll installations after Grafana Enterprise v8.1.0-beta1 should be upgraded as soon as possible. As an alternative, disabling fine-grained access control will mitigate the vulnerability. \r\n\r\nAppropriate patches have been applied to [Grafana Cloud](https://grafana.com/cloud) and as always, we closely coordinated with all cloud providers licensed to offer Grafana Pro. They have received early notification under embargo and confirmed that their offerings are secure at the time of this announcement. This is applicable to Amazon Managed Grafana and Azure's Grafana as a service offering.\r\n\r\n### Timeline and postmortem\r\n\r\nHere is a detailed timeline starting from when we originally learned of the issue. All times in UTC.\r\n\r\n- 2022-04-03 13:02 A potential Issue related to fine-grained access control escalated internally\r\n- 2022-04-03 12:07 Issue escalated and the vulnerability confirmed reproducible\r\n- 2022-04-03 14:30 Decision is made to release a private patch\r\n- 2022-04-04 09:06 CVE requested\r\n- 2022-04-04 12:40 Private release planned for 2022-04-05, and public release planned for 2022-04-12\r\n- 2022-04-04 12:40 GitHub has issued CVE-2022-24812\r\n- 2022-04-05 12:00 Private release\r\n- 2022-04-12 12:00 Public release\r\n\r\n## Reporting security issues\r\n\r\nIf you think you have found a security vulnerability, please send a report to [security@grafana.com](mailto:security@grafana.com). This address can be used for all of Grafana Labs's open source and commercial products (including but not limited to Grafana, Grafana Cloud, Grafana Enterprise, and grafana.com). We can accept only vulnerability reports at this address.\r\n\r\nPlease encrypt your message to us; please use our PGP key. The key fingerprint is:\r\n\r\nF988 7BEA 027A 049F AE8E 5CAA D125 8932 BE24 C5CA\r\n\r\nThe key is available from [keyserver.ubuntu.com](https://keyserver.ubuntu.com/pks/lookup?search=0xF9887BEA027A049FAE8E5CAAD1258932BE24C5CA\u0026fingerprint=on\u0026op=index).\r\n\r\nGrafana Labs will send you a response indicating the next steps in handling your report. After the initial reply to your report, the security team will keep you informed of the progress towards a fix and full announcement, and may ask for additional information or guidance.\r\n\r\n**Important:** We ask you to not disclose the vulnerability before it have been fixed and announced, unless you received a response from the Grafana Labs security team that you can do so.\r\n\r\n## Security announcements\r\n\r\nWe maintain a category on the community site called [Security Announcements](https://community.grafana.com/c/support/security-announcements),\r\nwhere we will post a summary, remediation, and mitigation details for any patch containing security fixes.\r\n\r\nYou can also subscribe to email updates to this category if you have a grafana.com account and sign on to the community site or track updates via an [RSS feed](https://community.grafana.com/c/support/security-announcements.rss).\r\n\r\n",
  "affected": [
    {
      "package": {
        "ecosystem": "DHI",
        "name": "grafana",
        "purl": "pkg:dhi/grafana"
      },
      "database_specific": {
        "source_ecosystem": "grafana",
        "source_package": "accesscontrol"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/grafana/grafana/security/advisories/GHSA-82gq-xfg3-5j7v"
    }
  ]
}